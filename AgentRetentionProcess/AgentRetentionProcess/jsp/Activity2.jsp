<%--  This JSP has been generated by using from xsl version 9.0 at Mon Nov 14 13:18:59 IST 2016 --%>
<!DOCTYPE html>
<html xmlns:bizsolo="http://www.savvion.com/sbm/BizSolo" xmlns:sbm="http://www.savvion.com/sbm" xmlns:jsp="http://java.sun.com/JSP/Page" xmlns:xalan="http://xml.apache.org/xalan" xmlns:fn="http://www.w3.org/2005/02/xpath-functions" xmlns:sfe="http://www.savvion.com/sbm/sfe" xmlns:c="http://java.sun.com/jsp/jstl/core">
<head><META http-equiv="Content-Type" content="text/html; charset=utf-8">

<%@ page contentType="text/html; charset=UTF-8" %>
<%@ page import="com.savvion.BizSolo.Server.*,com.savvion.BizSolo.beans.*,com.savvion.sbm.util.DatabaseMapping,java.util.Vector,java.util.Locale" %>
<%@ page import="com.savvion.sbm.bizsolo.util.session.*,java.net.*" %>
<%@ page errorPage="/BizSolo/common/jsp/expcontroller.jsp" %>
<%@ taglib uri="/BizSolo/common/tlds/bizsolo.tld" prefix="bizsolo" %>
<%@ taglib uri="/bpmportal/tld/bpmportal.tld" prefix="sbm" %>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<%@ taglib uri="http://java.sun.com/jsp/jstl/fmt" prefix="fmt" %>
<%@ taglib prefix="form" tagdir="/WEB-INF/tags/form"%>
<%@ taglib prefix="sfe" uri="http://jmaki/v1.0/jsp" %>
  <jsp:useBean id="bizManage" class="com.savvion.sbm.bizmanage.api.BizManageBean" scope="session"></jsp:useBean>
  <jsp:useBean id="bean" class="com.savvion.BizSolo.beans.Bean" scope="session"></jsp:useBean>
  <jsp:useBean id="factoryBean" class="com.savvion.BizSolo.beans.EPFactoryBean" scope="session"></jsp:useBean>
  <jsp:useBean id="bizSite" class="com.savvion.sbm.bpmportal.bizsite.api.BizSiteBean" scope="session"></jsp:useBean>
<%! String _PageName = "Spoc Resolution"; %>
<%! String __webAppName = "AgentRetentionProcess"; %>
<% pageContext.setAttribute( "contextPath", request.getContextPath()+"/"); %>
<% pageContext.setAttribute( "maxMultiLineLength", DatabaseMapping.self().getSQLSize(java.lang.String.class));  %>
<%java.util.List<String> priorities = com.savvion.sbm.bpmportal.util.PortalUtil.self().getPriorities();%>
<% pageContext.setAttribute( "_priorities",priorities); %>
<bizsolo:if test='<%=_PageName.equals(request.getParameter("_PageName")) %>'>
    <bizsolo:setDS name=""></bizsolo:setDS>
    <bizsolo:choose>
<bizsolo:when test='<%=request.getParameter("bizsite_reassignTask") !=null %>'>
      <bizsolo:initDS name="performer" param="bizsite_assigneeName" hexval="FALSE"></bizsolo:initDS>
      <bizsolo:executeAction epClassName="com.savvion.BizSolo.beans.PAKReassignWI" perfMethod="commit" mode="BizSite" dsi="" dso=""></bizsolo:executeAction>
</bizsolo:when>
<bizsolo:when test='<%=request.getParameter("bizsite_saveTask") !=null %>'>
      <bizsolo:executeAction epClassName="com.savvion.BizSolo.beans.PAKUpdateDS" perfMethod="commit" mode="BizSite" dsi=""></bizsolo:executeAction>
</bizsolo:when>
    <bizsolo:otherwise>
      <bizsolo:executeAction epClassName="com.savvion.BizSolo.beans.PAKSetDS" perfMethod="commit" mode="BizSite" dsi="" res=""></bizsolo:executeAction>
      </bizsolo:otherwise>
    </bizsolo:choose>
<% /* Workaround, retAddr will disappear in the future */ %>
<% String retAddr = bean.getPropString("returnPage"); %>
<% if(retAddr != null) { %>
<bizsolo:redirectURL page="<%= retAddr %>"/>
<% } %>
</bizsolo:if>
<bizsolo:if test='<%= ! _PageName.equals(request.getParameter("_PageName")) %>'>
    <bizsolo:initApp mode="BizSite" name="AgentRetentionProcess"></bizsolo:initApp>
    <bizsolo:executeAction epClassName="com.savvion.BizSolo.beans.PAKGetDS" perfMethod="commit" mode="BizSite" dso=""></bizsolo:executeAction>
</bizsolo:if>

<title>Spoc Resolution</title>
<%boolean isStandaloneBS = (bizManage == null || bizManage.getName() == null || "".equals(bizManage.getName()) || bizManage.getLocale() == null);Locale myLocale = (!isStandaloneBS) ? bizManage.getLocale() : request.getLocale();%>
<!-- Javascript -->
<script language="JavaScript"> var getLocalizedString = parent.getLocalizedString; </script>
<form:includes contextPath="${contextPath}"/>
<script language="JavaScript">
 Ext.BLANK_IMAGE_URL = '<c:out value='${contextPath}'/>bpmportal/javascript/ext/resources/images/default/s.gif';
	 
	  var isIFrame = <%= (PublicResources.INTERACTIVE_MODE.equalsIgnoreCase(bean.getPropString(PublicResources.MODE)) || PublicResources.SLAVE_MODE.equalsIgnoreCase(bean.getPropString(PublicResources.MODE))) ? true : false %>;
	  

	function getContextPath(){
        return "<%=request.getContextPath()%>";
    }
</script>


<sbm:setLocale value="<%= bizManage.getLocale() %>"></sbm:setLocale>
<% try{ %><sbm:setBundle scope="page" basename="AgentRetentionProcess/properties/AgentRetentionProcess"></sbm:setBundle><% } catch(Exception e){}%>
<bizsolo:getApplicationResources baseName="AgentRetentionProcess/properties/AgentRetentionProcess"/></head>
<body class="apbody yui-skin-sam" onLoad="setCheckBoxStyleForIE();hideControls();beforeInitControls();initControls();initTabs();sbm.utils.onDOMReady();">
<form method="post" name="form" onsubmit="return sbm.utils.onFormSubmit();">
<div id="northDiv" style="height:0px;display:none;"><bizsolo:xsrf/></div><% /* Workaround, activityName will disappear in the future */ %>
<% String activityName = bean.getPropString("workitemName"); %>
<div id="resultDiv">
<div style='visibility:hidden;display:none' class='vBoxClass' name='errors' id='errors'></div>
<input name="_PageName" type="hidden" value="Spoc Resolution">
<%if(bean.getPropString("workitemName") != null) {%><input name="_WorkitemName" type="hidden" value="<%= URLHexCoder.encode(bean.getPropString("workitemName")) %>"/><input name="_WorkitemId" type="hidden" value="<%= bean.getPropLong("workitemId") %>"/><%}%>
<input name="bizsite_pagetype" type="hidden" value="activity">
<input name="_ProcessTemplateName" type="hidden" value='<%=bean.getPropString("ptName")%>'>
<input name="_yahoo_flow_button" type="hidden" value=''>
<!-- Content --> 

    
    <%@ page import="com.savvion.sbm.bizlogic.server.ejb.BLServer" %>
<%@ page import="com.savvion.sbm.bizlogic.client.BLClientUtil" %>
<%@ page import="com.savvion.sbm.bizlogic.util.Session" %>
<%@ page import="com.savvion.sbm.bizlogic.server.svo.ProcessInstance" %>
<script language="JavaScript" src="scripts/jquery-1.11.1.js"></script>
<script language="JavaScript" src="scripts/jquery-ui.min.js"></script>
<script language="JavaScript" src="scripts/jquery.multiselect.js"></script>
<script language="JavaScript" src="scripts/custom.js"></script>
<link rel="stylesheet" type="text/css" href="style/custom.css" />
<link rel="stylesheet" type="text/css" href="style/jquery-ui.css" />
<link rel="stylesheet" type="text/css" href="style/jquery.multiselect.css" />
<%
BLServer blServer = BLClientUtil.getBizLogicServer(); 
Session blSession = bizSite.getBizlogicSession();
long piID = Long.parseLong(activityName.split("::")[0].split("#")[1].trim());
ProcessInstance pi = blServer.getProcessInstance(blSession, piID);
%>
<%!
    String checkNull(String val)
    {
       if(val != null && val.trim().length() > 0)
       {
           return val.trim();
       }
       else
       {
          return "";
       }
    }
%>
<div class="header">Spoc Resolution</div>
<div>
 <h4>AGENT DETAIL</h4>
    <table class="agentDtl">
        <tr>
           <td class="fieldName">Agent Code</td>
           <td class="fieldValue"><%= checkNull((String)pi.getDataSlotValue("agent_code")) %></td>
           <td class="fieldName">Agent Name</td>
           <td class="fieldValue">Harish Rajpurohit</td>
           <td class="fieldName">Licence Type</td>
           <td class="fieldValue"><%= checkNull((String)pi.getDataSlotValue("licence_type")) %></td>
        </tr>
        <tr>
           <td class="fieldName">Vintage Month</td>
           <td class="fieldValue"><%= checkNull((String)pi.getDataSlotValue("vintage_month")) %></td>
           <td class="fieldName">Fresh Per</td>
           <td class="fieldValue"><%= checkNull((String)pi.getDataSlotValue("fresh_per")) %></td>
           <td class="fieldName">Policy Gap</td>
           <td class="fieldValue"><%= checkNull((String)pi.getDataSlotValue("policy_gap")) %></td>
        </tr>
        <tr>
           <td class="fieldName">Sales Category</td>
           <td class="fieldValue"><%= checkNull((String)pi.getDataSlotValue("sales_category")) %></td>
           <td class="fieldName">Time Last Pol</td>
           <td class="fieldValue"><%= checkNull((String)pi.getDataSlotValue("time_last_pol")) %></td>
           <td class="fieldName">Claim Per Category</td>
           <td class="fieldValue"><%= checkNull((String)pi.getDataSlotValue("claim_per_category")) %></td>
        </tr>
        <tr>
           <td class="fieldName">Claim TAT Category</td>
           <td class="fieldValue"><%= checkNull((String)pi.getDataSlotValue("claim_TAT_category")) %></td>
           <td class="fieldName">Payout TAT Category</td>
           <td class="fieldValue"><%= checkNull((String)pi.getDataSlotValue("payout_TAT_category")) %></td>
           <td class="fieldName">SM Status</td>
           <td class="fieldValue"><%= checkNull((String)pi.getDataSlotValue("sm_status")) %></td>
        </tr>
        <tr>
           <td class="fieldName">SM Level Vintage</td>
           <td class="fieldValue"><%= checkNull((String)pi.getDataSlotValue("sm_level_vintage")) %></td>
           <td class="fieldName">Attrition Probability</td>
           <td class="fieldValue"><%= checkNull((String)pi.getDataSlotValue("attrition_probability")) %></td>
           <td class="fieldName">Business Last 12 Month</td>
           <td class="fieldValue"><%= checkNull((String)pi.getDataSlotValue("business_last_12month")) %></td>
        </tr>
        <tr>
           <td class="fieldName">Business Category</td>
           <td class="fieldValue"><%= checkNull((String)pi.getDataSlotValue("business_category")) %></td>
           <td class="fieldName">Attrition Risk</td>
           <td class="fieldValue"><%= checkNull((String)pi.getDataSlotValue("attrition_risk")) %></td>
           <td class="fieldName"></td>
           <td class="fieldValue"></td>
        </tr>
   </table>
</div>
<div>
    <h4>UPDATE DETAIL</h4>
    <table class="agentDtl" id='updationTbl'>
        <tr>
           <td class="fieldName">Claim</td>
           <td class="fieldValue">
              <select id='claimDD' multiple='multiple'>
              </select>
           </td>
           <td class="fieldValue">
              <select id='claimSpocDD' multiple='multiple'>
              </select>
           </td>
           <td class="fieldValue">
             <textarea id='claimDDRmk' rows='2' cols='24'></textarea>
           </td>
        </tr>
        <tr>
           <td class="fieldName">UnderWriter</td>
           <td class="fieldValue">
              <select id='uwDD' multiple='multiple'>
              </select>
           </td>
           <td class="fieldValue">
              <select id='uwSpocDD' multiple='multiple'>
              </select>
           </td>
           <td class="fieldValue">
             <textarea id='uwDDRmk' rows='2' cols='24'></textarea>
           </td>
        </tr>      
        <tr>
           <td class="fieldName">Operations</td>
           <td class="fieldValue">
              <select id='opsDD' multiple='multiple'>
              </select>
           </td>
           <td class="fieldValue">
              <select id='opsSpocDD' multiple='multiple'>
              </select>
           </td>
           <td class="fieldValue">
             <textarea id='opsDDRmk' rows='2' cols='24'></textarea>
           </td>
        </tr>
        <tr>
           <td class="fieldName">IT</td>
           <td class="fieldValue">
              <select id='itDD' multiple='multiple'>
              </select>
           </td>
           <td class="fieldValue">
              <select id='itSpocDD' multiple='multiple'>
              </select>
           </td>
           <td class="fieldValue">
             <textarea id='itDDRmk' rows='2' cols='24'></textarea>
           </td>
        </tr>
        <tr>
           <td class="fieldName">Accounts</td>
           <td class="fieldValue">
              <select id='accountDD' multiple='multiple'>
              </select>
           </td>
           <td class="fieldValue">
              <select id='accountSpocDD' multiple='multiple'>
              </select>
           </td>
           <td class="fieldValue">
             <textarea id='accountDDRmk' rows='2' cols='24'></textarea>
           </td>
        </tr>
        <tr>
           <td class="fieldName">Strategy</td>
           <td class="fieldValue">
              <select id='strategyDD' multiple='multiple'>
              </select>
           </td>
           <td class="fieldValue">
              <select id='strategySpocDD' multiple='multiple'>
              </select>
           </td>
           <td class="fieldValue">
             <textarea id='strategyDDRmk' rows='2' cols='24'></textarea>
           </td>
        </tr>
      </table><br />

<%@ page import="java.sql.*"%>
<%@ page import="com.agent.portal.GetResource"%>


 <%
           Connection connection = null;
           PreparedStatement pstmt = null;
           ResultSet rset = null;
           GetResource obj = new GetResource();
           try
           {
               String query = "SELECT REMARKS FROM AGENTBMGRID WHERE PROCESS_INSTANCE_ID = ? AND SPOC LIKE ?";
               connection = obj.getDBConnection();
               pstmt = connection.prepareStatement(query);
               pstmt.setLong(1,piID);
               pstmt.setString(2,"%"+bizSite.getCurrentUser()+"%");
               rset = pstmt.executeQuery();
               while(rset.next())
               {
       %>
              
              <div class='header' style='height:20px;margin-bottom:10px;'></div>
              <table class='agentDtl'>
                <tr>
                    <td class='fieldName' style='height:35px;'>Remark : </td>
                    <td class='fieldValue' style='width:100%;' colspan='3'><%= rset.getString(1) %></td>
                    <td></td><td></td>
                </tr>
             </table>
 
      <%
               }
           }
           catch(Exception e)
           {
               System.out.println("Error : "+e.getMessage());
           }
           finally
           {
               obj.releaseResource(connection,pstmt,rset);
           }
    
    %>



      <br />
      <table class='agentDtl'>
        <tr>
          <td class='fileName' colspan='4' style='text-align:center;padding-top:20px;'>
             <image src='images/submit.png' height='30' width='100' style='cursor:pointer;' onClick='saveDetail();' />
          </td>
       </tr>
    </table>
</div>
    
  
                    <div id="resizablepanel" style="display:none">
                        <div class="hd">Alert Dialog</div>
                        <div class="bd"></div>
                        <div class="ft"></div>
                    </div> 
<div id="southDiv" style="height:0px;display:none;"></div></form>
</body>

<script language="JavaScript">
<!--
function beforeInitControls() {
}
-->
</script>
<script language="JavaScript">
<!--
function userValidationJavascript() {
return true;
}
-->
</script>
<sbm:dataSources appName="AgentRetentionProcess" appType="bizlogic">
</sbm:dataSources>
<script language="JavaScript">
<!--
$(document).ready(function(){



    pwr.getClaim(callBackClaim);



});







function callBackClaim(value)



{



   $.each(value,function(key,val){



       $('#claimDD').append($('<option></option>').val(key).html(val));



   });



   $('#claimDD').multiselect({



           beforeclose : function(event,ui){enableNextOption('claimDD','claimSpocDD','Select Claims'),setSpocList('claimDD','claimSpocDD','getClaimSpocs')},



    });   



   pwr.getUW(callBackUW);



}







function callBackUW(value)



{



   $.each(value,function(key,val){



       $('#uwDD').append($('<option></option>').val(key).html(val));



   });



   $('#uwDD').multiselect({beforeclose : function(event,ui){enableNextOption('uwDD','uwSpocDD','Select UW'),setSpocList('uwDD','uwSpocDD','getUWSpocs')}});   



   pwr.getOps(callBackOps);



}







function callBackOps(value)



{



   $.each(value,function(key,val){



       $('#opsDD').append($('<option></option>').val(key).html(val));



   });



   $('#opsDD').multiselect({beforeclose : function(event,ui){enableNextOption('opsDD','opsSpocDD','Select Ops'),setSpocList('opsDD','opsSpocDD','getOpsSpocs')}});   



   pwr.getIT(callBackIT);



}







function callBackIT(value)



{



   $.each(value,function(key,val){



       $('#itDD').append($('<option></option>').val(key).html(val));



   });



   $('#itDD').multiselect({beforeclose : function(event,ui){enableNextOption('itDD','itSpocDD','Select IT'),setSpocList('itDD','itSpocDD','getITSpocs')}});   



   pwr.getAccounts(callBackAccounts);



}







function callBackAccounts(value)



{



   $.each(value,function(key,val){



       $('#accountDD').append($('<option></option>').val(key).html(val));



   });



   $('#accountDD').multiselect({beforeclose : function(event,ui){enableNextOption('accountDD','accountSpocDD','Select Accounts'),setSpocList('accountDD','accountSpocDD','getAccountsSpocs')}});   



   pwr.getStrategy(callBackStrategy);



}







function callBackStrategy(value)



{



   $.each(value,function(key,val){



       $('#strategyDD').append($('<option></option>').val(key).html(val));



   });



   $('#strategyDD').multiselect({beforeclose : function(event,ui){enableNextOption('strategyDD','strategySpocDD','Select Strategy'),setSpocList('strategyDD','strategySpocDD','getStrategySpocs')}});



      



   $('#claimSpocDD').multiselect({beforeopen : function(event,ui){checkOptionSelected('claimDD','claimSpocDD')}});   



   $('#uwSpocDD').multiselect({beforeopen : function(event,ui){checkOptionSelected('uwDD','uwSpocDD')}});   



   $('#opsSpocDD').multiselect({beforeopen : function(event,ui){checkOptionSelected('opsDD','opsSpocDD')}});   



   $('#itSpocDD').multiselect({beforeopen : function(event,ui){checkOptionSelected('itDD','itSpocDD')}});   



   $('#accountSpocDD').multiselect({beforeopen : function(event,ui){checkOptionSelected('accountDD','accountSpocDD')}});   



   $('#strategySpocDD').multiselect({beforeopen : function(event,ui){checkOptionSelected('strategyDD','strategySpocDD')}});   



   



   $('#claimDD').siblings().children().eq(1).html('Select Claims');



   $('#uwDD').siblings().children().eq(1).html('Select UW');



   $('#opsDD').siblings().children().eq(1).html('Select Ops');



   $('#itDD').siblings().children().eq(1).html('Select IT');



   $('#accountDD').siblings().children().eq(1).html('Select Accounts');



   $('#strategyDD').siblings().children().eq(1).html('Select Strategy');



   



   $('#claimSpocDD').siblings().children().eq(1).html('Select Claim Spocs');



   $('#uwSpocDD').siblings().children().eq(1).html('Select UW Spocs');



   $('#opsSpocDD').siblings().children().eq(1).html('Select Ops Spocs');



   $('#itSpocDD').siblings().children().eq(1).html('Select IT Spocs');



   $('#accountSpocDD').siblings().children().eq(1).html('Select Accounts Spocs');



   $('#strategySpocDD').siblings().children().eq(1).html('Select Strategy Spocs');



   $('select').multiselect({header:'',height:100});



}







function checkOptionSelected(ParentId,CurrentId)



{



     var value = $('#'+ParentId).val();



     if(value == '' || value == null)



     {



          $('#'+CurrentId).multiselect('disable');



          $('#'+ParentId).multiselect('open');



     }



}







function enableNextOption(CurrentId,childId,Msg)



{



     var value = $('#'+CurrentId).val();



     if(value != '' && value != null)



     {



          $('#'+childId).multiselect('enable');



     }



     else



     {



          $('#'+CurrentId).siblings().children().eq(1).html(Msg);



     }



}







var _childId;



function setSpocList(currentId,childId,pwrName)



{



    _childId = childId;



    var obj = document.getElementById(currentId),



        options = obj.options, 



        selected = [], i, str;



    for (i = 0; i < options.length; i++) {



        options[i].selected && selected.push(obj[i].value.split('-')[0]);



    }



    str = selected.join();



    if(str != null && str != '')



    {



        if(pwrName == 'getClaimSpocs')



        {



            pwr.getClaimSpocs(str,callbackSetSpoc);



        }



        else if(pwrName == 'getUWSpocs')



        {



            pwr.getUWSpocs(str,callbackSetSpoc);



	}



        else if(pwrName == 'getOpsSpocs')



	{



            pwr.getOpsSpocs(str,callbackSetSpoc);



	}



        else if(pwrName == 'getITSpocs')



	{



            pwr.getITSpocs(str,callbackSetSpoc);



	}



        else if(pwrName == 'getAccountsSpocs')



	{



            pwr.getAccountsSpocs(str,callbackSetSpoc);



	}



        else if(pwrName == 'getStrategySpocs')



	{



            pwr.getStrategySpocs(str,callbackSetSpoc);



	}



    }



}







function callbackSetSpoc(spocs)



{



     $('#'+_childId).html('');



     $.each(spocs,function(key,val){



       $('#'+_childId).append($('<option></option>').val(val).html(val));



   });



   $('#'+_childId).multiselect('refresh');



}







function saveDetail()



{

     var map = {};



    $('#updationTbl tbody tr').each(function() {

           var sbctgy = $(this).find('td:eq(1)').find('select').val();    

           if(sbctgy != '' && sbctgy != null)

           {

                var ctgy = $(this).find('td:eq(0)').html();

                var spocs = $(this).find('td:eq(2)').find('select').val();

                var rmks = $(this).find('td:eq(3)').find('textarea').val();

                sbctgy = sbctgy.toString();

                var sbctgyArr = sbctgy.split(',');

                var _sbctgy = '';

                for(var i = 0; i < sbctgyArr.length; i++)

                {

                    _sbctgy = _sbctgy+''+sbctgyArr[i].split('-')[1]+','; 

                }

                _sbctgy = _sbctgy.substring(0,_sbctgy.length-1);

                map[ctgy] = _sbctgy+'####'+spocs+'####'+rmks;

           }

    });

    pwr.submitBMGrid('<%=activityName.split("::")[0].split("#")[1]%>',map,callbackGrid);



}



function callbackGrid(val)

{

    if(val = 'Submit')

     {

         //document.getElementById('button01').click;

     }

}
-->
</script>
<!--Initialize extensible widgets.-->
<script language="JavaScript">
<!--
var _dateFormats = {date:'<%=bean.getPropString(PublicResources.JS_CALENDAR_DATE_FORMAT)%>', dateOnly:'<%=bean.getPropString(PublicResources.JS_CALENDAR_DATE_ONLY_FORMAT)%>'};

var allWidgets = [];
var businessObjects = [];
var formWidgetHandler;

sbm.utils.onDOMReady = function() {
YAHOO.util.Event.onDOMReady(function(){
formWidgetHandler = new FormWidgetHandler(allWidgets,null,{processName:'AgentRetentionProcess',processType:'bizlogic',maxMultiLineLength:${maxMultiLineLength},adapletCache:{}},'<%=request.getParameter(BizSoloRequest.BSS_FIID)%>');
 });
 }
Ext.onReady(function(){
 var task = new Ext.util.DelayedTask(function(){
});
  task.delay(500);
  var viewport = new Bm.util.BmViewport('',{resultComponentXtype:'container'});

});
sbm.utils.onFormSubmit = function() {
         if(!formWidgetHandler.validateWidgets()) return false;
        try{
             if(!userValidationJavascript()) return false;
             sbm.utils.handleFormSubmit();
         }catch(e){return false;}
         document.form.action='<%=response.encodeURL("Activity2.jsp")%>';
         if(allWidgets.length > 0)formWidgetHandler.saveDataSlots();
         return true;
}
-->
</script>

</html>