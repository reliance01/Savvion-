<%--  This JSP has been generated by using from xsl version 9.0 at Wed Mar 09 17:53:22 IST 2022 --%>
<!DOCTYPE html>
<html xmlns:sbm="http://www.savvion.com/sbm" xmlns:bizsolo="http://www.savvion.com/sbm/BizSolo" xmlns:jsp="http://java.sun.com/JSP/Page" xmlns:xalan="http://xml.apache.org/xalan" xmlns:fn="http://www.w3.org/2005/02/xpath-functions" xmlns:sfe="http://www.savvion.com/sbm/sfe" xmlns:c="http://java.sun.com/jsp/jstl/core">
<head><META http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge">

<%@ page contentType="text/html; charset=UTF-8" %>
<%@ page import="com.savvion.BizSolo.Server.*,com.savvion.BizSolo.beans.*,com.savvion.sbm.util.DatabaseMapping,java.util.Vector,java.util.Locale" %>
<%@ page import="com.savvion.sbm.bizsolo.util.session.*,java.net.*" %>
<%@ page errorPage="/BizSolo/common/jsp/expcontroller.jsp" %>
<%@ taglib uri="/BizSolo/common/tlds/bizsolo.tld" prefix="bizsolo" %>
<%@ taglib uri="/bpmportal/tld/bpmportal.tld" prefix="sbm" %>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<%@ taglib uri="http://java.sun.com/jsp/jstl/fmt" prefix="fmt" %>
<%@ taglib prefix="form" tagdir="/WEB-INF/tags/form"%>
<%@ taglib prefix="sfe" uri="http://jmaki/v1.0/jsp" %>
  <jsp:useBean id="bizManage" class="com.savvion.sbm.bizmanage.api.BizManageBean" scope="session"></jsp:useBean>
  <jsp:useBean id="bean" class="com.savvion.BizSolo.beans.Bean" scope="session"></jsp:useBean>
  <jsp:useBean id="factoryBean" class="com.savvion.BizSolo.beans.EPFactoryBean" scope="session"></jsp:useBean>
  <jsp:useBean id="bizSite" class="com.savvion.sbm.bpmportal.bizsite.api.BizSiteBean" scope="session"></jsp:useBean>
<%! String _PageName = "Spoc Resolution"; %>
<%! String __webAppName = "AgentRetentionProcess"; %>
<% pageContext.setAttribute( "contextPath", request.getContextPath()+"/"); %>
<% pageContext.setAttribute( "maxMultiLineLength", DatabaseMapping.self().getSQLSize(java.lang.String.class));  %>
<%java.util.List<String> priorities = com.savvion.sbm.bpmportal.util.PortalUtil.self().getPriorities();%>
<% pageContext.setAttribute( "_priorities",priorities); %>
<bizsolo:if test='<%=_PageName.equals(request.getParameter("_PageName")) %>'>
    <bizsolo:setDS name="isReopen,isComplete,tempSpoc,bm,role,agent_code"></bizsolo:setDS>
    <bizsolo:choose>
<bizsolo:when test='<%=request.getParameter("bizsite_reassignTask") !=null %>'>
      <bizsolo:initDS name="performer" param="bizsite_assigneeName" hexval="FALSE"></bizsolo:initDS>
      <bizsolo:executeAction epClassName="com.savvion.BizSolo.beans.PAKReassignWI" perfMethod="commit" mode="BizSite" dsi="" dso="tempSpoc,agent_code,role,bm,isReopen,isComplete"></bizsolo:executeAction>
</bizsolo:when>
<bizsolo:when test='<%=request.getParameter("bizsite_saveTask") !=null %>'>
      <bizsolo:executeAction epClassName="com.savvion.BizSolo.beans.PAKUpdateDS" perfMethod="commit" mode="BizSite" dsi="tempSpoc,agent_code,role,bm,isReopen,isComplete"></bizsolo:executeAction>
</bizsolo:when>
    <bizsolo:otherwise>
      <bizsolo:executeAction epClassName="com.savvion.BizSolo.beans.PAKSetDS" perfMethod="commit" mode="BizSite" dsi="tempSpoc,agent_code,role,bm,isReopen,isComplete" res=""></bizsolo:executeAction>
      </bizsolo:otherwise>
    </bizsolo:choose>
<% /* Workaround, retAddr will disappear in the future */ %>
<% String retAddr = bean.getPropString("returnPage"); %>
<% if(retAddr != null) { %>
<bizsolo:redirectURL page="<%= retAddr %>"/>
<% } %>
</bizsolo:if>
<bizsolo:if test='<%= ! _PageName.equals(request.getParameter("_PageName")) %>'>
    <bizsolo:initApp mode="BizSite" name="AgentRetentionProcess"></bizsolo:initApp>
<bizsolo:initDS name="isReopen" type="STRING"></bizsolo:initDS>
<bizsolo:initDS name="isComplete" type="STRING"></bizsolo:initDS>
<bizsolo:initDS name="tempSpoc" type="STRING"></bizsolo:initDS>
<bizsolo:initDS name="bm" type="STRING"></bizsolo:initDS>
<bizsolo:initDS name="role" type="STRING"></bizsolo:initDS>
<bizsolo:initDS name="agent_code" type="STRING"></bizsolo:initDS>
    <bizsolo:executeAction epClassName="com.savvion.BizSolo.beans.PAKGetDS" perfMethod="commit" mode="BizSite" dso="tempSpoc,agent_code,role,bm,isReopen,isComplete"></bizsolo:executeAction>
</bizsolo:if>

<title>Spoc Resolution</title>
<%boolean isStandaloneBS = (bizManage == null || bizManage.getName() == null || "".equals(bizManage.getName()) || bizManage.getLocale() == null);Locale myLocale = (!isStandaloneBS) ? bizManage.getLocale() : request.getLocale();%>
<!-- Javascript -->
<script language="JavaScript"> var getLocalizedString = parent.getLocalizedString; </script>
<form:includes contextPath="${contextPath}"/>
<script language="JavaScript">
     
      var isIFrame = <%= (PublicResources.INTERACTIVE_MODE.equalsIgnoreCase(bean.getPropString(PublicResources.MODE)) || PublicResources.SLAVE_MODE.equalsIgnoreCase(bean.getPropString(PublicResources.MODE))) ? true : false %>;
      

    function getContextPath(){
        return "<%=request.getContextPath()%>";
    }
</script>


<sbm:setLocale value="<%= bizManage.getLocale() %>"></sbm:setLocale>
<% try{ %><sbm:setBundle scope="page" basename="AgentRetentionProcess/properties/AgentRetentionProcess"></sbm:setBundle><% } catch(Exception e){}%>
<bizsolo:getApplicationResources baseName="AgentRetentionProcess/properties/AgentRetentionProcess"/></head>
<body class="apbody yui-skin-sam" onLoad="setCheckBoxStyleForIE();hideControls();beforeInitControls();initControls();initTabs();sbm.utils.onDOMReady();">
<form method="post" name="form" onsubmit="return sbm.utils.onFormSubmit();">
<div id="northDiv" style="height:0px;display:none;"><bizsolo:xsrf/></div><% /* Workaround, activityName will disappear in the future */ %>
<% String activityName = bean.getPropString("workitemName"); %>
<div id="resultDiv">
<div style='visibility:hidden;display:none' class='vBoxClass' name='errors' id='errors'></div>
<input name="_PageName" type="hidden" value="Spoc Resolution">
<%if(bean.getPropString("workitemName") != null) {%><input name="_WorkitemName" type="hidden" value="<%= URLHexCoder.encode(bean.getPropString("workitemName")) %>"/><input name="_WorkitemId" type="hidden" value="<%= bean.getPropLong("workitemId") %>"/><%}%>
<input name="bizsite_pagetype" type="hidden" value="activity">
<input name="_ProcessTemplateName" type="hidden" value='<%=bean.getPropString("ptName")%>'>
<input name="_yahoo_flow_button" type="hidden" value=''>
<!-- Content --> 

    
    
<%@ page import="com.savvion.sbm.bizlogic.server.ejb.BLServer" %>
<%@ page import="com.savvion.sbm.bizlogic.client.BLClientUtil" %>
<%@ page import="com.savvion.sbm.bizlogic.util.Session" %>
<%@ page import="com.savvion.sbm.bizlogic.server.svo.ProcessInstance" %>
<script language="JavaScript" src="scripts/jquery-1.11.1.js"></script>
<script language="JavaScript" src="scripts/jquery-ui.min.js"></script>
<script language="JavaScript" src="scripts/jquery.multiselect.js"></script>
<script language="JavaScript" src="scripts/custom.js"></script>
<link rel="stylesheet" type="text/css" href="style/custom.css" />
<link rel="stylesheet" type="text/css" href="style/jquery-ui.css" />
<link rel="stylesheet" type="text/css" href="style/jquery.multiselect.css" />
<%
BLServer blServer = BLClientUtil.getBizLogicServer(); 
Session blSession = bizSite.getBizlogicSession();
long piID = Long.parseLong(activityName.split("::")[0].split("#")[1].trim());
ProcessInstance pi = blServer.getProcessInstance(blSession, piID);
%>
<%!
    String checkNull(String val)
    {
       if(val != null && val.trim().length() > 0)
       {
           return val.trim();
       }
       else
       {
          return "";
       }
    }
%>
<div class="header">Spoc Resolution</div>
<div>

  <table class="agentDtl">
        <tr>
          <td class="fieldName" colspan='6' style='text-align:center;padding-top:5px;padding-bottom:5px;'>AGENT DETAIL</td>
        </tr>
        <tr>
           <td class="fieldName">Agent Code</td>
           <td class="fieldValue"><%= checkNull((String)pi.getDataSlotValue("agent_code")).split("-")[0] %></td>
           <td class="fieldName">Agent Name</td>
           <td class="fieldValue"><%= checkNull((String)pi.getDataSlotValue("agent_code")).split("-")[1] %></td>
           <td class="fieldName">SM Status</td>
           <td class="fieldValue"><%= checkNull((String)pi.getDataSlotValue("sm_status")) %></td>
        </tr>
        <tr>
           <td class="fieldName">SM Name</td>
           <td class="fieldValue"><%= checkNull((String)pi.getDataSlotValue("sm_name")) %></td>
           <td class="fieldName">SM Code</td>
           <td class="fieldValue"><%= checkNull((String)pi.getDataSlotValue("sm_code")) %></td>
           <td class="fieldName">Branch Code</td>
           <td class="fieldValue"><%= checkNull((String)pi.getDataSlotValue("branch_code")) %></td>
        </tr>
        <tr>
           <td class="fieldName">Branch Name</td>
           <td class="fieldValue"><%= checkNull((String)pi.getDataSlotValue("branch_name")) %></td>
	<td class="fieldName">Unique Reference Number</td>
           <td class="fieldValue"><%= Long.parseLong(activityName.split("::")[0].split("#")[1].trim()) %></td>
        </tr>
       
   </table>
</div>




<table id = 'bmTable' class="agentDtl">
	<thead>
        <tr>
            <th class="fieldName" colspan='10' style="text-align:center;padding-top:5px;padding-bottom:5px;">SPOC Resolution Details</th>
        </tr>
        <tr>
              <th class="fieldName"  style="width: 3.2%;text-align:center;">Sr. No.</th>
              <th class="fieldName" style="width: 5%;text-align:center;">Department</th>
	      <th class="fieldName" style="width: 10%;text-align:center;padding-left: 5px;">Category</th>
	      <th class="fieldName" style="text-align:center;">BM Remark</th>
              <th class="fieldName" style="width: 5%;text-align:center;">BM Sumbit Date</th>
	      <th class="fieldName" style="width: 10%;text-align:center;padding-left: 5px;">Spoc</th>
	      <th class="fieldName" style="text-align:center;">Spoc Remark</th>
              <th class="fieldName" style="width: 5%;text-align:center;">Spoc Submit Date</th>
             <!-- <th class="fieldName" style="width: 10%;text-align:center;padding-left: 5px;">Reassign By</th> //-->
              <th class="fieldName" style="width: 5%;text-align:center;">Status</th>
        </tr>
       </thead>

       <tbody id = 'bmTable_body'>
       </tbody>
   </table>
<div id = 'bmDiv' style="display:none">
  <div  id='submitBtnDiv' style="display:none"> 
        
        <table class='agentDtl'>
        <tr>
         <td class="fieldName"  style='width:3.2%;'>
              Select Status
         </td>

         <td class="fieldValue" colspan='3''>
               <select id='bmStatusDropDown'>
                 <option value="0" selected>Select</option>
                 <option value="1">Reopen</option>
                 
                 <option value="2">Resolved</option>
               </select>
         </td>
         
        </tr>
      
     </table>  
 <div id='resolvedDiv' style='display:none;'>
   <table class='agentDtl'>
        <tr>
          
           <td class="fieldName" style='width:3.2%;'>Closure Remarks</td>
           <td class="fieldName" colspan='3' >
           <textarea id='completeRmk' rows='2' cols='60' ></textarea></td>
	  
	
	</tr>
   </table>
   </div>

    <table class='agentDtl'>
        <tr>
          <td class='fieldValue' colspan='6' style='text-align:center;padding-top:10px;'>
             <image src='images/submit.png' height='30' width='100' style='cursor:pointer;' onClick='saveBMDetail();' />
          </td>
       </tr>
    </table>

</div>

</div>
<div id='spocDiv'>

<table class='agentDtl'>
	<tr>
            <td class="fieldName"  style='width:2%; text-align:left; padding-right:10px;'>BM Remarks</td>
           <td class="fieldValue" >
             <textarea id='bmRmk' rows='2' cols='60' readonly></textarea>
	   </td>
 	
        </tr>
        </table>
 
<table class='agentDtl'>
        <tr>
         <td class="fieldName"  style='width:2%;'>
              Select Status
         </td>

         <td class="fieldValue" colspan='3''>
               <select id='spocStatusDropDown'>
                 <option value="0" selected>Select</option>
                 <option value="1">Provide Resolution</option>
                 
                 <option value="2">Forword To SPOC</option>
               </select>
         </td>
         
        </tr>
      
     </table>  

<div id='rmkSpocDiv' style='display:none;'>
     <table class="agentDtl">
	<td class="fieldName"  style='width:2%; text-align:left; padding-right:10px;'>Your Remarks</td>
           <td class="fieldValue" >
             <textarea id='spocRmk' rows='2' cols='60' class='spocRmkCls'></textarea>
		</td>
      </table>
</div>
  

<div id='forwordSpocDiv' style='display:none;'>
    <table class="agentDtl" id='updationTbl'>
        <tr>
           <td class="fieldName">Claim</td>
           <td class="fieldValue">
              <select id='claimDD' class='DD' multiple='multiple'>
              </select>
           </td>
           <td class="fieldValue">
              <select id='claimSpocDD' class='spocDD' multiple='multiple'>
              </select>
           </td>
           <td class="fieldValue">
             <textarea class="remark" id='claimDDRmk' rows='2' cols='35' disabled='disabled'></textarea>
           </td>
        </tr>
        <tr>
           <td class="fieldName">UnderWriter</td>
           <td class="fieldValue">
              <select id='uwDD' class='DD' multiple='multiple'>
              </select>
           </td>
           <td class="fieldValue">
              <select id='uwSpocDD' class='spocDD' multiple='multiple'>
              </select>
           </td>
           <td class="fieldValue">
             <textarea class="remark" id='uwDDRmk' rows='2' cols='35' disabled='disabled'></textarea>
           </td>
        </tr>      
        <tr>
           <td class="fieldName">Operations</td>
           <td class="fieldValue">
              <select id='opsDD' class='DD' multiple='multiple'>
              </select>
           </td>
           <td class="fieldValue">
              <select id='opsSpocDD' class='spocDD' multiple='multiple'>
              </select>
           </td>
           <td class="fieldValue">
             <textarea class="remark" id='opsDDRmk' rows='2' cols='35' disabled='disabled'></textarea>
           </td>
        </tr>
        <tr style='display:none;'>
           <td class="fieldName">IT</td>
           <td class="fieldValue">
              <select id='itDD' class='DD' multiple='multiple'>
              </select>
           </td>
           <td class="fieldValue">
              <select id='itSpocDD' class='spocDD' multiple='multiple'>
              </select>
           </td>
           <td class="fieldValue">
             <textarea class="remark" id='itDDRmk' rows='2' cols='35' disabled='disabled'></textarea>
           </td>
        </tr>
        <tr>
           <td class="fieldName">Accounts</td>
           <td class="fieldValue">
              <select id='accountDD' class='DD' multiple='multiple'>
              </select>
           </td>
           <td class="fieldValue">
              <select id='accountSpocDD' class='spocDD' multiple='multiple'>
              </select>
           </td>
           <td class="fieldValue">
             <textarea class="remark" id='accountDDRmk' rows='2' cols='35' disabled='disabled'></textarea>
           </td>
        </tr>
        <tr style='display:none;'>
           <td class="fieldName">Strategy</td>
           <td class="fieldValue">
              <select id='strategyDD' class='DD' multiple='multiple'>
              </select>
           </td>
           <td class="fieldValue">
              <select id='strategySpocDD' class='spocDD' multiple='multiple'>
              </select>
           </td>
           <td class="fieldValue">
             <textarea class="remark" id='strategyDDRmk' rows='2' cols='35' disabled='disabled'></textarea>
           </td>
        </tr>
      </table>
</div>
 <div id='assignedSpocDiv' style='display:none'>
      <table class='agentDtl'>
       <tr>
             <td class="fieldName"  style='width:15%; text-align:right; padding-right:10px; padding-left:200px;'>Don't Select Following SPOC</td>
             <td class="fieldValue" > <textarea id='assignedSpoc' rows='2' cols='90' disabled='disabled'></textarea>
              </td>
       </tr>
      </table>
      </div>
  
       
	

  <div id='submitBtnDiv'>
        <table class='agentDtl'>
        <tr>
          <td class='fieldValue' colspan='6' style='text-align:center;padding-top:10px;'>
             <image src='images/submit.png' height='30' width='100' style='cursor:pointer;' onClick='saveDetail();' />
          </td>
       </tr>
    </table>
<div style="display:none">
   <textarea id='manipulateSpoc' rows='2' cols='60'></textarea>
</div>
</div>
</div>



    <br clear="all">
<br clear="all">
<br clear="all">
<br clear="all">
<br clear="all">
<br clear="all">
<div style="display:none">
    <br clear="all">
<br clear="all">
<br clear="all">
<Label class="ApSegDataslotLabel" id="" for="textField1"><sbm:message key="dataslot.Spoc Resolution.isReopen.label"></sbm:message></Label>
    <sfe:widget name="sbm.textfield" id="isReopen" args="{'type':'text', 'size':20, 'maxlength':50, 'readonly':false, 'visible':true, 'disabled':false, 'validationType':'none', 'validation':{}, 'toolTip':'Savvion textfield widget', 'tabOrder':'0'}" />

    <br clear="all">
<br clear="all">
<Label class="ApSegDataslotLabel" id="" for="textField2"><sbm:message key="dataslot.Spoc Resolution.isComplete.label"></sbm:message></Label>
    <sfe:widget name="sbm.textfield" id="isComplete" args="{'type':'text', 'size':20, 'maxlength':50, 'readonly':false, 'visible':true, 'disabled':false, 'validationType':'none', 'validation':{}, 'toolTip':'Savvion textfield widget', 'tabOrder':'0'}" />

    <br clear="all">
<br clear="all">
<Label class="ApSegDataslotLabel" id="" for="textField1"><sbm:message key="dataslot.Spoc Resolution.tempSpoc.label"></sbm:message></Label>
    <sfe:widget name="sbm.textfield" id="tempSpoc" args="{'type':'text', 'size':20, 'maxlength':500, 'readonly':false, 'visible':true, 'disabled':false, 'validationType':'none', 'validation':{}, 'toolTip':'Savvion textfield widget', 'tabOrder':'0'}" />

    <Label class="ApSegDataslotLabel" id="" for="textField1"><sbm:message key="dataslot.Spoc Resolution.bm.label"></sbm:message></Label>
    <sfe:widget name="sbm.textfield" id="bm" args="{'type':'text', 'size':20, 'maxlength':50, 'readonly':false, 'visible':true, 'disabled':false, 'validationType':'none', 'validation':{}, 'toolTip':'Savvion textfield widget', 'tabOrder':'0'}" />

    <Label class="ApSegDataslotLabel" id="" for="textField1"><sbm:message key="dataslot.Spoc Resolution.role.label"></sbm:message></Label>
    <sfe:widget name="sbm.textfield" id="role" args="{'type':'text', 'size':20, 'maxlength':50, 'readonly':false, 'visible':true, 'disabled':false, 'validationType':'none', 'validation':{}, 'toolTip':'Savvion textfield widget', 'tabOrder':'0'}" />

    <br clear="all">
<table align="center" cellpadding="0" cellspacing="0" id="" width="100%">
      <colgroup span="1">
        <col span="1">
        <col span="1">
      </colgroup>
      <tbody>
        <tr>
          <td align="left" class="(default)" colspan="2" id="" style="text-align:left;vertical-align:top" valign="top" rowspan="1">
            <input class="ApScrnButton" name="bizsite_completeTask" id="button_complete" type="submit" tabindex="0" value="<bizsolo:getLabel name='COMPLETE_LABEL' type='RESOURCE'/>" onMouseOut="this.className='ApScrnButton';" onMouseOver="this.className='ApScrnButtonHover';" onClick="clickedButton=this.name;this.onsubmit = new Function('return false');">

            <input class="ApScrnButton" name="bizsite_saveTask" id="button_save" type="submit" tabindex="0" value="<bizsolo:getLabel name='SAVE_LABEL' type='RESOURCE'/>" onMouseOut="this.className='ApScrnButton';" onMouseOver="this.className='ApScrnButtonHover';" onClick="clickedButton=this.name;this.onsubmit = new Function('return false');">

            <input class="ApScrnButton" name="bizsite_reset" id="button_reset" type="button" tabindex="0" value="<bizsolo:getLabel name='RESET_LABEL' type='RESOURCE'/>" onMouseOut="this.className='ApScrnButton';" onMouseOver="this.className='ApScrnButtonHover';" onClick="sbm.utils.reset();">

            <input class="ApScrnButton" name="Submit1323" id="button_cancel" type="button" tabindex="0" value="<bizsolo:getLabel name='CANCEL_LABEL' type='RESOURCE'/>" onMouseOut="this.className='ApScrnButton';" onMouseOver="this.className='ApScrnButtonHover';" onClick="sbm.utils.cancel();">

            <sfe:widget name="sbm.textfield" id="bizsite_assigneeName" args="{'type':'text', 'size':15, 'maxlength':256, 'readonly':false, 'visible':true, 'disabled':false, 'validationType':'none', 'validation':{}, 'toolTip':'', 'tabOrder':'0'}" />

            <img border="0" id="image1" width="32" height="32" src="<c:out value='${contextPath}'/>bpmportal/css/apptheme01/images/icon_edit_user_search_single.gif" tabindex="0">
            <input class="ApScrnButton" name="bizsite_reassignTask" id="button_reassign" type="submit" tabindex="0" value="<bizsolo:getLabel name='REASSIGN_LABEL' type='RESOURCE'/>" onMouseOut="this.className='ApScrnButton';" onMouseOver="this.className='ApScrnButtonHover';" onClick="clickedButton=this.name;return AlertReassign();this.onsubmit = new Function('return false');">

          </td>
        </tr>
      </tbody>
    </table>
    <br clear="all">
<Label class="ApSegDataslotLabel" id="" for="textField1"><sbm:message key="dataslot.Spoc Resolution.agent_code.label"></sbm:message></Label>
    <sfe:widget name="sbm.textfield" id="agent_code" args="{'type':'text', 'size':20, 'maxlength':50, 'readonly':false, 'visible':true, 'disabled':false, 'validationType':'none', 'validation':{}, 'toolTip':'Savvion textfield widget', 'tabOrder':'0'}" />

    <br clear="all">
<br clear="all">
<br clear="all">
</div>
    
  
                    <div id="resizablepanel" style="display:none">
                        <div class="hd">Alert Dialog</div>
                        <div class="bd"></div>
                        <div class="ft"></div>
                    </div> 
<div id="southDiv" style="height:0px;display:none;"></div></form>
</body>

<script language="JavaScript">
<!--
function beforeInitControls() {
}
-->
</script>
<script language="JavaScript">
<!--
function userValidationJavascript() {
return true;
}
-->
</script>
<sbm:dataSources appName="AgentRetentionProcess" appType="bizlogic">
</sbm:dataSources>
<script language="JavaScript">
<!--
$(document).ready(function(){



    pwr.getClaim(callBackClaim);



});





function callBackClaim(value)





{



   $.each(value,function(key,val){



       $('#claimDD').append($('<option></option>').val(key).html(val));





   });





   $('#claimDD').multiselect({





           beforeclose : function(event,ui){enableNextOption('claimDD','claimSpocDD','Select Claims','Select Claims Spoc','claimDDRmk'),setSpocList('claimDD','claimSpocDD','getClaimSpocs')},





    });   



 pwr.getUW(callBackUW);



}



function callBackUW(value)





{







   $.each(value,function(key,val){





       $('#uwDD').append($('<option></option>').val(key).html(val));





   });





   $('#uwDD').multiselect({beforeclose : function(event,ui){enableNextOption('uwDD','uwSpocDD','Select UW','Select UW Spoc','uwDDRmk'),setSpocList('uwDD','uwSpocDD','getUWSpocs')}});   





   pwr.getOps(callBackOps);





}





function callBackOps(value)







{







   $.each(value,function(key,val){







       $('#opsDD').append($('<option></option>').val(key).html(val));





   });





   $('#opsDD').multiselect({beforeclose : function(event,ui){enableNextOption('opsDD','opsSpocDD','Select Ops','Select Ops Spoc','spocDDRmk'),setSpocList('opsDD','opsSpocDD','getOpsSpocs')}});   





   pwr.getIT(callBackIT);







}





function callBackIT(value)



{



   $.each(value,function(key,val){



      $('#itDD').append($('<option></option>').val(key).html(val));



   });





   $('#itDD').multiselect({beforeclose : function(event,ui){enableNextOption('itDD','itSpocDD','Select IT','Select IT Spoc','itDDRmk'),setSpocList('itDD','itSpocDD','getITSpocs')}});   



   pwr.getAccounts(callBackAccounts);





}



function callBackAccounts(value)



{





   $.each(value,function(key,val){



     $('#accountDD').append($('<option></option>').val(key).html(val));





   });



   $('#accountDD').multiselect({beforeclose : function(event,ui){enableNextOption('accountDD','accountSpocDD','Select Accounts','Select Accounts Spoc','accountDDRmk'),setSpocList('accountDD','accountSpocDD','getAccountsSpocs')}});   



   pwr.getStrategy(callBackStrategy);



}





function callBackStrategy(value)



{



   $.each(value,function(key,val){



       $('#strategyDD').append($('<option></option>').val(key).html(val));



   });



   $('#strategyDD').multiselect({beforeclose : function(event,ui){enableNextOption('strategyDD','strategySpocDD','Select Strategy','Select Strategy Spocs','strategyDDRmk'),setSpocList('strategyDD','strategySpocDD','getStrategySpocs')}});



   $('#claimSpocDD').multiselect({beforeopen : function(event,ui){checkOptionSelected('claimDD','claimSpocDD')}});   







   $('#uwSpocDD').multiselect({beforeopen : function(event,ui){checkOptionSelected('uwDD','uwSpocDD')}});   







   $('#opsSpocDD').multiselect({beforeopen : function(event,ui){checkOptionSelected('opsDD','opsSpocDD')}});   





   $('#itSpocDD').multiselect({beforeopen : function(event,ui){checkOptionSelected('itDD','itSpocDD')}});   





   $('#accountSpocDD').multiselect({beforeopen : function(event,ui){checkOptionSelected('accountDD','accountSpocDD')}});   





   $('#strategySpocDD').multiselect({beforeopen : function(event,ui){checkOptionSelected('strategyDD','strategySpocDD')}});   







   $('#claimSpocDD').multiselect({beforeclose : function(event,ui){enableRemark(this.id, 'claimDDRmk')}}); 







   $('#uwSpocDD').multiselect({beforeclose : function(event,ui){enableRemark(this.id, 'uwDDRmk')}}); 







   $('#opsSpocDD').multiselect({beforeclose : function(event,ui){enableRemark(this.id, 'opsDDRmk')}}); 







   $('#itSpocDD').multiselect({beforeclose : function(event,ui){enableRemark(this.id, 'itDDRmk')}}); 







   $('#accountSpocDD').multiselect({beforeclose : function(event,ui){enableRemark(this.id, 'accountDDRmk')}}); 







   $('#strategySpocDD').multiselect({beforeclose : function(event,ui){enableRemark(this.id, 'strategyDDRmk')}});   









   //Remark Validations









    $('#claimDD').change(function(){disableRemark(this.id, 'claimDDRmk')});







    $('#uwDD').change(function(){disableRemark(this.id, 'uwDDRmk')});







    $('#opsDD').change(function(){disableRemark(this.id, 'opsDDRmk')});







    $('#itDD').change(function(){disableRemark(this.id, 'itDDRmk')});







    $('#accountDD').change(function(){disableRemark(this.id, 'accountDDRmk')});







    $('#strategyDD').change(function(){disableRemark(this.id, 'strategyDDRmk')});















     $('#claimSpocDD').change(function(){disableRemark(this.id, 'claimDDRmk')});







    $('#uwSpocDD').change(function(){disableRemark(this.id, 'uwDDRmk')});







    $('#opsSpocDD').change(function(){disableRemark(this.id, 'opsDDRmk')});







    $('#itSpocDD').change(function(){disableRemark(this.id, 'itDDRmk')});







    $('#accountSpocDD').change(function(){disableRemark(this.id, 'accountDDRmk')});







    $('#strategySpocDD').change(function(){disableRemark(this.id, 'strategyDDRmk')});















    







    $('.spocChkBox').click(function(){checkSpocAction(this.id)});





  $('.DD').multiselect({header:'',height:100});

  $('.spocDD').multiselect({header:'',height:100});









    $('.remark').focusout(function(){checkRemark(this.id)});















   $('#claimDD').siblings().children().eq(1).html('Select Claims');















   $('#uwDD').siblings().children().eq(1).html('Select UW');















   $('#opsDD').siblings().children().eq(1).html('Select Ops');















   $('#itDD').siblings().children().eq(1).html('Select IT');















   $('#accountDD').siblings().children().eq(1).html('Select Accounts');















   $('#strategyDD').siblings().children().eq(1).html('Select Strategy');









   $('#claimSpocDD').siblings().children().eq(1).html('Select Claim Spocs');









   $('#uwSpocDD').siblings().children().eq(1).html('Select UW Spocs');







   $('#opsSpocDD').siblings().children().eq(1).html('Select Ops Spocs');







   $('#itSpocDD').siblings().children().eq(1).html('Select IT Spocs');











   $('#accountSpocDD').siblings().children().eq(1).html('Select Accounts Spocs');









   $('#strategySpocDD').siblings().children().eq(1).html('Select Strategy Spocs');











    $('#immediateManagerId').attr('disabled', true);







    $('#ownRmk').attr('disabled', true);















   if( $('#managerRmk').val() == '')







      {







      $('#managerRmk').attr('disabled', true);







        }







	else{ $('#managerRmk').attr('disables', true);}














	 $('#isImmediateManagerCall').val('');







  $('#isComplete').val('');



  $('#isReopen').val('');



  







  







  var remark = $('#immediateManagerRemark').val();







$('#managerRmk').val(remark);







var mgrId = $('#immediateManager').val();







$('#immediateManagerId').val(mgrId);



 







 



   var currentUser = <%= bizSite.getCurrentUser() %>;



   



   var bm = <%= checkNull((String)pi.getDataSlotValue("bm")) %>;



 



   //alert("currentUser : "+ currentUser +" bm is : " + bm);







   var user = currentUser.toString();



   var piid = <%=activityName.split("::")[0].split("#")[1]%>;



  



   if(currentUser == bm)



   {

  

     $('#spocDiv').hide();



    



     $('#bmDiv').show();

 

     pwr.getAssignedSpoc(piid,callBackAssignedSpocBM);



   }



   else



   {






   // var user = currentUser.toString();



  //  var piid = <%=activityName.split("::")[0].split("#")[1]%>;



    pwr.getBmRemarks(piid,user,callBackBmRemark);



 



   }











  $('.spocChkBox').click(function(){checkSpocAction(this.id)});



  $('.bmChkBox').click(function(){checkBmAction(this.id)}); 



  



  $("#bmStatusDropDown").change(function(){

    checkBmStatus();

   });



  



$("#spocStatusDropDown").change(function(){

    checkSpocStatus();

   });







 pwr.getSpocResolution(piid,spocResolutionCallback);



$('.spocDD').change(function() {



            

            $('.spocDD').multiselect('close');

            $('.spocDD').multiselect('disable');

            

            $('.DD').multiselect('disable');



             });  



}





function checkBmStatus()

{

var selectedValue = $('#bmStatusDropDown').val();

	if(selectedValue == '1')

          {

            $('#resolvedDiv').hide();

            

          }

         else if(selectedValue == '2')

          {

            $('#completeRmk').val('');

            $('#resolvedDiv').show();

            $('#completeRmk').focus();

          

          }else

          {

           $('#resolvedDiv').hide();

           

          }



}



function checkSpocStatus()

{

var selectedValue = $('#spocStatusDropDown').val();

	if(selectedValue == '1')

      {

       $('#spocRmk').val('');

             

       $('#rmkSpocDiv').val('').show();

       $('#spocRmk').focus();

        $('#forwordSpocDiv').hide(); 

       resetSpoc(); 

      } else if(selectedValue == '2')

      {

 	$('#rmkSpocDiv').hide();

        $('#forwordSpocDiv').show();  

       resetSpoc(); 

       var piid = <%=activityName.split("::")[0].split("#")[1]%>;

         pwr.getAssignedSpoc(piid,callBackAssignedSpoc);

            console.log('after Method'); 

      }else

 	{

          $('#rmkSpocDiv').hide();

          $('#forwordSpocDiv').hide(); 

        resetSpoc(); 

        }

}





function callBackBmRemark(value)



{







$('#bmRmk').val(value.split('*123#')[0]);



var checkSpoc = value.split('*123#')[1];



if(checkSpoc != 'None')

{

$('#spocTd').hide();

}



}







function callBackAssignedSpocBM(value)

{



var rows = value.length;

console.log('in side --- :'+rows);

if(rows == '0')

{

$('#submitBtnDiv').show();

}



}





function spocResolutionCallback(value)



{



console.log(value.length);







var row = value.length;







for(var i=0 ; i < row ; i++ )



{







var abc = value[i];







var count = document.getElementById("bmTable_body").rows.length;



var newHtml="";



count++;







newHtml+="<tr>";



newHtml+="<td class=\"fieldValue\" style=\"width: 3.2%; text-align:center;\">"+count+"</td>";



newHtml+="<td class=\"fieldValue\" style=\"width: 5%; text-align:center;\">"+abc["CATEGORY"]+"</td>";



newHtml+="<td class=\"fieldValue\" style=\"width: 10%; padding-left: 5px; text-align:center;\">"+abc["SUB_CATEGORY"]+"</td>";



newHtml+="<td class=\"fieldValue\" style=\" text-align:center;\" >"+abc["REMARKS"]+"</td>";



newHtml+="<td class=\"fieldValue\" style=\"width: 5%; text-align:center;\">"+abc["BM_SUBMIT_DATE"]+"</td>";



var spoc = abc["SPOC"].split('-')[0];



newHtml+="<td class=\"fieldValue\" style=\"width: 10%; padding-left: 5px ; text-align:center; \">"+spoc+"</td>";



var spocRmk = abc["SPOC_REMARK"];

if(spocRmk == 'Pending')

{

spocRmk = '-';

}



newHtml+="<td class=\"fieldValue\" style=\" text-align:center;\">"+spocRmk+"</td>";



var spocDate = abc["SPOC_SUBMIT_DATE"];

if(spocDate == 'N/A')

{

spocDate = '-';

}



newHtml+="<td class=\"fieldValue\" style=\"width: 5%; text-align:center;\">"+spocDate+"</td>";



var reassignBy = abc["REASSIGNBY"];

if(reassignBy == 'None')

{

reassignBy = '-';

}

else

{

reassignBy = abc["REASSIGNBY"].split('-')[1];

}

//newHtml+="<td class=\"fieldValue\" style=\"width: 10%; text-align:center; padding-left: 5px; \">"+reassignBy+"</td>";



newHtml+="<td class=\"fieldValue\" style=\"width: 5%; text-align:center;\">"+abc["STATUS"]+"</td>";



newHtml+="</tr>";



var div = document.getElementById('bmTable_body');



div.innerHTML = div.innerHTML + newHtml;



console.log('are you'+abc);







}







}















//Remark Validation method



















  function enableRemark(spocDDId, remarkId)







	{







			var spoc = $('#'+spocDDId).val();







			if(spoc == '' || spoc == null)







			  {







			  







			  $('#'+remarkId).attr('disabled' ,true).removeAttr('placeholder').val('');















			  }







			else{







			   $('#'+remarkId).attr('disabled' ,false).focus();







			  







			   }







	}















   function disableRemark(spocDDId, remarkId)







	{







			var spoc = $('#'+spocDDId).val();







			if(spoc == '' || spoc == null)







			  {







			  $('#'+remarkId).attr('disabled' ,true).removeAttr('placeholder').val('');







			  }







			







			







	}







    function checkRemark(remarkId)







	{







			var remark = $('#'+remarkId).val();







                       	if(remark.trim() =='' || remark.trim() == null)







			   {







				







				//$('#'+remarkId).attr('placeholder' ,'Please fill remark').focus();







				alert(' Please Fill Remarks !!!');







				$('#'+remarkId).focus();







				$('.DD').multiselect('disable');

                                 $('.spocDD').multiselect('disable');







					







				







			   }else







			{   







			







			// $('#'+remarkId).removeAttr('placeholder');







			//	$('select').multiselect('enable');	







				  }







                       







         }







    















function checkOptionSelected(ParentId,CurrentId)















{















     var value = $('#'+ParentId).val();















     if(value == '' || value == null)















     {















          $('#'+CurrentId).multiselect('disable');















          $('#'+ParentId).multiselect('open');















     }















}















//for check action















function checkSpocAction(chkBoxId)







{















  if(chkBoxId == 'spocChkBox')







     



     { 



      $('#resolutionChkBox').attr('checked',false);



      



      disableSpocRmk();



     



      var piid = <%=activityName.split("::")[0].split("#")[1]%>;

   

    pwr.getAssignedSpoc(piid,callBackAssignedSpoc);



      







     if($('#'+chkBoxId).is(':checked'))







     {



   





    

    $('#assignedSpocDiv').show();





    $('.spocDD').multiselect('enable');



    $('.DD').multiselect('enable');







    







     resetSpoc();



 



  



    



          //  $('.DD').change(function() {



             



           // $('.DD').multiselect('disable');



           //  });     



           



            $('.spocDD').change(function() {



            



            $('.spocDD').multiselect('disable');

            $('.DD').multiselect('disable');



             });  











        }







     else{



           



            disableSpoc();



           

           $('#assignedSpocDiv').hide();





         }







 







     } else{







       if($('#'+chkBoxId).is(':checked'))



      {



       $('#spocChkBox').attr('checked',false);



       disableSpoc();



$('#assignedSpocDiv').hide();



     enableSpocRmk();



      }else



      {



       disableSpocRmk();



        }







       }











}













function disableSpocRmk()



{ 







$('.spocRmkCls').val('');



$('.spocRmkCls').attr('disabled', true);







}







function enableSpocRmk()



{







$('.spocRmkCls').val('');



$('.spocRmkCls').attr('disabled', false);







}







function resetSpoc()

{







$('.DD').multiselect('enable');

$('.spocDD').multiselect('enable');



$('.DD').multiselect('uncheckAll');







$('.spocDD').multiselect('uncheckAll');















 $('#claimDD').siblings().children().eq(1).html('Select Claims');















   $('#uwDD').siblings().children().eq(1).html('Select UW');















   $('#opsDD').siblings().children().eq(1).html('Select Ops');















   $('#itDD').siblings().children().eq(1).html('Select IT');















   $('#accountDD').siblings().children().eq(1).html('Select Accounts');















   $('#strategyDD').siblings().children().eq(1).html('Select Strategy');















   















   $('#claimSpocDD').siblings().children().eq(1).html('Select Claim Spocs');















   $('#uwSpocDD').siblings().children().eq(1).html('Select UW Spocs');















   $('#opsSpocDD').siblings().children().eq(1).html('Select Ops Spocs');















   $('#itSpocDD').siblings().children().eq(1).html('Select IT Spocs');















   $('#accountSpocDD').siblings().children().eq(1).html('Select Accounts Spocs');















   $('#strategySpocDD').siblings().children().eq(1).html('Select Strategy Spocs');







 



 $('.DD').multiselect('enable');

 $('.spocDD').multiselect('enable');



   







$('.remark').val('');







$('.remark').removeAttr('placeholder');







$('.remark').attr('disable',true);











}







function disableSpoc()







{



$('.DD').multiselect('disable');



$('.spocDD').multiselect('disable');







$('.DD').multiselect('uncheckAll');







$('.spocDD').multiselect('uncheckAll');







$('.remark').val('');







$('.remark').removeAttr('placeholder');







$('.remark').attr('disable',true);







resetSpoc();











}































function enableNextOption(CurrentId,childId,Msg,childMsg,remarkId)















{















     var value = $('#'+CurrentId).val();















     if(value != '' && value != null)















     {















          $('#'+childId).multiselect('enable');















     }















     else















     {















          $('#'+CurrentId).siblings().children().eq(1).html(Msg);







	  $('#'+childId).siblings().children().eq(1).html(childMsg);







	  $('#'+remarkId).attr('disabled' ,true).removeAttr('placeholder').val('');















     }















}























var _childId;















function setSpocList(currentId,childId,pwrName)















{















    _childId = childId;















    var obj = document.getElementById(currentId),















        options = obj.options, 















        selected = [], i, str;















    for (i = 0; i < options.length; i++) {















        options[i].selected && selected.push(obj[i].value.split('-')[0]);















    }















    str = selected.join();















    if(str != null && str != '')















    {















        if(pwrName == 'getClaimSpocs')















        {















            pwr.getClaimSpocs(str,callbackSetSpoc);















        }















        else if(pwrName == 'getUWSpocs')















        {















            pwr.getUWSpocs(str,callbackSetSpoc);















	}















        else if(pwrName == 'getOpsSpocs')















	{















            pwr.getOpsSpocs(str,callbackSetSpoc);















	}















        else if(pwrName == 'getITSpocs')















	{















            pwr.getITSpocs(str,callbackSetSpoc);















	}















        else if(pwrName == 'getAccountsSpocs')















	{















            pwr.getAccountsSpocs(str,callbackSetSpoc);















	}















        else if(pwrName == 'getStrategySpocs')















	{















            pwr.getStrategySpocs(str,callbackSetSpoc);















	}















    }















}































function callbackSetSpoc(spocs)















{















     $('#'+_childId).html('');















     $.each(spocs,function(key,val){















      $('#'+_childId).append($('<option></option>').val(val).html(val.split('-',2)[1])); 















   });











   $('#'+_childId).multiselect('refresh');







    











}







function checkBmAction(chkBoxId)







{











  if(chkBoxId == 'reopenChkBox')







     



     { 



      $('#completeChkBox').attr('checked',false);



      



      



     if($('#'+chkBoxId).is(':checked'))







            {



   







            }







 







    } else{







       if($('#'+chkBoxId).is(':checked'))



      {



       $('#reopenChkBox').attr('checked',false);



     



      }       }











}











function saveBMDetail()



{







var selectedValue = $('#bmStatusDropDown').val();



if(selectedValue == '1')



{


$("img").hide();




$('#isReopen').val('1');



$('#button_complete').click();



}else if(selectedValue == '2')



{



var closureRmk = $('#completeRmk').val();



if(closureRmk.trim() == '')

{



alert('Please Enter Closure Remarks !!!');



return false;



}else{

$("img").hide();

pwr.updateCompleteStatus('<%=activityName.split("::")[0].split("#")[1]%>',closureRmk,callbackComplete);



}

}else



{



alert("Please select atleast one status !!!");







}



}



function callbackComplete(val)

{



if(val = 'Sucess')

 {

             $('#isComplete').val('1');



         $('#button_complete').click();

  }



}



function callBackAssignedSpoc(value)

{



var rows = value.length;

console.log(rows);

var spocName ='';

var spocValue = '';

for (var i=0; rows > i; i++)

{

   spocName = spocName + value[i].split('-')[0] +'-';

   spocValue = spocValue + value[i]+',';

}



$('#assignedSpoc').val(spocName.slice(0,-1));

$('#manipulateSpoc').val(spocValue.slice(0,-1));

console.log('callbackassignedmethod' + $('#manipulateSpoc').val());

console.log()

}



function saveDetail()





{



  



  var selectedValue = $('#spocStatusDropDown').val();



      if(selectedValue == '2')



	{

          





           if($('#claimSpocDD').val() != null)



                { 



                   //alert('code run');



                }



            else if($('#uwSpocDD').val() != null)



                { 



                   //alert('code run');



                }



            else if($('#opsSpocDD').val() != null)



                { 



                   //alert('code run');



                }



            else if($('#itSpocDD').val() != null)



                { 



                   //alert('code run');



                }



             else if($('#accountSpocDD').val() != null)



                { 



                   //alert('code run');



                }



               else if($('#strategySpocDD').val() != null)



                { 



                   //alert('code run');



                }else{



                alert("Please select atleast one category !!!!!");



                       return false};







           

           var piid = <%=activityName.split("::")[0].split("#")[1]%>;

   

          



            pwr.getAssignedSpoc(piid,callBackAssignedSpoc);

           



            var map = {};



            var currentUser = <%= bizSite.getCurrentUser() %>;



            var user = currentUser.toString();



             



            $('#updationTbl tbody tr').each(function() {



           var sbctgy = $(this).find('td:eq(1)').find('select').val(); 



           var spocs = $(this).find('td:eq(2)').find('select').val();   



           if(spocs != '' && spocs != null)



           {



                var ctgy = $(this).find('td:eq(0)').html();



                console.log(ctgy);



                var spocs = $(this).find('td:eq(2)').find('select').val();



                console.log(spocs);



		 var rmks = $(this).find('td:eq(3)').find('textarea').val();

                 



                sbctgy = sbctgy.toString();



                var sbctgyArr = sbctgy.split(',');



            



              var ctgId="";



              for(i=0 ; i < sbctgyArr.length; i++)



              {



               ctgId = ctgId + sbctgyArr[i].split("-")[0]+',';



              }



              ctgIdArr = ctgId.split(',');



             



                var spocStr = spocs.toString();



                var spocArr = spocStr.split(',');



                console.log(spocArr.length);



                



                for(var j = 0; j < spocArr.length; j++)



                {



          	    var spocId = spocArr[j].split('-')[0];



                    var id = ctgIdArr.indexOf(spocId);



                    var spocData = spocArr[j].split('-');



                   // assignedSpocs += spocData[2]+',';



                    var spocValue = spocData[1]+'-'+spocData[2]; 



                    var manipulateSpocArr = $('#manipulateSpoc').val().split(',');



                    console.log('manipulateSPOArr '+ manipulateSpocArr);



                    var doAllow = manipulateSpocArr.indexOf(spocValue);



                    console.log('doAllow value = ' + doAllow);



                    if(doAllow >= 0)

                    {

                    alert('You can not select following spoc !!!');

                   

                    disableSpoc();



           

                     $('#assignedSpocDiv').hide();



                    $('#spocChkBox').attr('checked', false);

                    return false;

                    }

   $("img").hide();

                    map[ctgy] = sbctgyArr[id].split('-')[1]+'####'+spocValue+'####'+rmks;



                    console.log('in methoddddd ' + manipulateSpocArr);

                    console.log('Before Pwr!!!!!');

                    pwr.submitBMGrid('<%=activityName.split("::")[0].split("#")[1]%>',user,map,callbackGrid);

                    

                    

                    

                    pwr.setSpocRemarks('<%=activityName.split("::")[0].split("#")[1]%>',user,'Reassigned to '+spocValue,'Forward',callbackSpocRemarkByDefault);



                    pwr.reAssign('<%= bean.getPropLong("workitemId") %>',spocData[2],piid,callbackReAssign);



                }



               map = {};

             











           }



         







         });











	











         }















	







	else if(selectedValue == '1')







	{







             var spocRemark = $('#spocRmk').val();



             if(spocRemark.trim() == '')



             {



             alert("Please Fill Your Remarks !!!");



             $('#spocRmk').focus();



             }



	     else{



            



             var flag = "Pending";







             if (flag.toLowerCase() === spocRemark.toLowerCase().trim())



              {



                  alert("You Can't use Pending in remarks !!!");



              }



             else{



             var piid = <%=activityName.split("::")[0].split("#")[1]%>;



             var currentUser = <%= bizSite.getCurrentUser() %>;



             var user = currentUser.toString();



             pwr.setSpocRemarks(piid,user,spocRemark,'Resolved',callbackSetSpocRemarks);



           $("img").hide();



             }



             }



        }



	else{



       alert('Pleae Select Atleast One Status !!!!');



	}















}



function callbackReAssign(val)

{

if(val = 'Performer Changed');

window.history.go(-1);

}



function callbackSpocRemarkByDefault(val)

{

console.log('Default remark inserted sucessfully!!');



}

function callbackCheckEscalateCondition(value)
{
var rows = value.length;
if(rows == 0)
{
var performerId = $('#bm').val();
var newRole = $('#role').val();
var escalationDays = 5;
pwr.insertPerformerEscalation(<%=activityName.split("::")[0].split("#")[1]%>,performerId,newRole,escalationDays,callbackinsertPerformerEscalation);
}
}

function callbackinsertPerformerEscalation(value)
{
console.log('Escalation Update Sucessfully');
pwr.bmTaskNotifyComplete(<%=activityName.split("::")[0].split("#")[1]%>,'spocmailbody',callbackbmTask);
}

function callbackbmTask(value)
{
console.log('mail sent');
}

function callbackSetSpocRemarks(val)



{



if (val = 'Submit')



  {

     var piid = <%=activityName.split("::")[0].split("#")[1]%>;

     pwr.getAssignedSpoc(piid,callbackCheckEscalateCondition);

   

      $('#button_complete').click();



  }



  



}











function callbackGrid(val)







{



   //console.log('in callback sublit bm grid!!!!!');



     if(val = 'Submit')







     {







    //   alert("task completed for spoccc!!!!!"); 	







        //    $('#button_complete').click();







     }















}
-->
</script>
<!--Initialize extensible widgets.-->
<script language="JavaScript">
<!--
var _dateFormats = {date:'<%=bean.getPropString(PublicResources.JS_CALENDAR_DATE_FORMAT)%>', dateOnly:'<%=bean.getPropString(PublicResources.JS_CALENDAR_DATE_ONLY_FORMAT)%>'};

var allWidgets = [{widget:'isReopen', bound:'true', editable:'true', type:'sbm.textfield', source: {type:'DATASLOT', dataSlotName:'isReopen', dataSlotType:'STRING'}, target:{type:'DATASLOT', dataSlotName:'isReopen', dataSlotType:'STRING'}, dsType:'STRING', service:'false'},
{widget:'isComplete', bound:'true', editable:'true', type:'sbm.textfield', source: {type:'DATASLOT', dataSlotName:'isComplete', dataSlotType:'STRING'}, target:{type:'DATASLOT', dataSlotName:'isComplete', dataSlotType:'STRING'}, dsType:'STRING', service:'false'},
{widget:'tempSpoc', bound:'true', editable:'true', type:'sbm.textfield', source: {type:'DATASLOT', dataSlotName:'tempSpoc', dataSlotType:'STRING'}, target:{type:'DATASLOT', dataSlotName:'tempSpoc', dataSlotType:'STRING'}, dsType:'STRING', service:'false'},
{widget:'bm', bound:'true', editable:'true', type:'sbm.textfield', source: {type:'DATASLOT', dataSlotName:'bm', dataSlotType:'STRING'}, target:{type:'DATASLOT', dataSlotName:'bm', dataSlotType:'STRING'}, dsType:'STRING', service:'false'},
{widget:'role', bound:'true', editable:'true', type:'sbm.textfield', source: {type:'DATASLOT', dataSlotName:'role', dataSlotType:'STRING'}, target:{type:'DATASLOT', dataSlotName:'role', dataSlotType:'STRING'}, dsType:'STRING', service:'false'},
{widget:'bizsite_assigneeName', bound:'false', editable:'true', type:'sbm.textfield', source: {type:'STATIC'}, target:{type:'DATASLOT', dataSlotName:'', dataSlotType:''}, dsType:'', service:'false'},
{widget:'agent_code', bound:'true', editable:'true', type:'sbm.textfield', source: {type:'DATASLOT', dataSlotName:'agent_code', dataSlotType:'STRING'}, target:{type:'DATASLOT', dataSlotName:'agent_code', dataSlotType:'STRING'}, dsType:'STRING', service:'false'}
];
var businessObjects = [];
var formWidgetHandler;

sbm.utils.onDOMReady = function() {
YAHOO.util.Event.onDOMReady(function(){
formWidgetHandler = new FormWidgetHandler(allWidgets,null,{processName:'AgentRetentionProcess',processType:'bizlogic',maxMultiLineLength:${maxMultiLineLength},adapletCache:{'user':''}},'<%=request.getParameter(BizSoloRequest.BSS_FIID)%>');
 });
 }
Ext.onReady(function(){
 var task = new Ext.util.DelayedTask(function(){
});
  task.delay(500);
  var viewport = new Bm.util.BmViewport('',{resultComponentXtype:'container'});

});

   
    scrollToErrors = function() {
        var errorsDiv = document.getElementById('errors');
        if(errorsDiv !== null) {
            errorsDiv.scrollIntoView();
        }
    }
    sbm.utils.onFormSubmit = function() {
        if(!formWidgetHandler.validateWidgets()) {
            scrollToErrors();
            return false;
        }
        try{
            if(!userValidationJavascript()) {
                scrollToErrors();
                return false;
            }              
            sbm.utils.handleFormSubmit();
        }catch(e){
            scrollToErrors();
            return false;
        }

                            document.form.action='<%=response.encodeURL("SpocResolution.jsp")%>';
         if(allWidgets.length > 0)formWidgetHandler.saveDataSlots();
         return true;
}
-->
</script>

</html>