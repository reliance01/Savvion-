<%--  This JSP has been generated by using from xsl version 9.0 at Wed Mar 09 17:54:12 IST 2022 --%>
<!DOCTYPE html>
<html xmlns:sbm="http://www.savvion.com/sbm" xmlns:bizsolo="http://www.savvion.com/sbm/BizSolo" xmlns:jsp="http://java.sun.com/JSP/Page" xmlns:xalan="http://xml.apache.org/xalan" xmlns:fn="http://www.w3.org/2005/02/xpath-functions" xmlns:sfe="http://www.savvion.com/sbm/sfe" xmlns:c="http://java.sun.com/jsp/jstl/core">
<head><META http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge">

<%@ page contentType="text/html; charset=UTF-8" %>
<%@ page import="com.savvion.BizSolo.Server.*,com.savvion.BizSolo.beans.*,com.savvion.sbm.util.DatabaseMapping,java.util.Vector,java.util.Locale" %>
<%@ page import="com.savvion.sbm.bizsolo.util.session.*,java.net.*" %>
<%@ page errorPage="/BizSolo/common/jsp/expcontroller.jsp" %>
<%@ taglib uri="/BizSolo/common/tlds/bizsolo.tld" prefix="bizsolo" %>
<%@ taglib uri="/bpmportal/tld/bpmportal.tld" prefix="sbm" %>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<%@ taglib uri="http://java.sun.com/jsp/jstl/fmt" prefix="fmt" %>
<%@ taglib prefix="form" tagdir="/WEB-INF/tags/form"%>
<%@ taglib prefix="sfe" uri="http://jmaki/v1.0/jsp" %>
  <jsp:useBean id="bizManage" class="com.savvion.sbm.bizmanage.api.BizManageBean" scope="session"></jsp:useBean>
  <jsp:useBean id="bean" class="com.savvion.BizSolo.beans.Bean" scope="session"></jsp:useBean>
  <jsp:useBean id="factoryBean" class="com.savvion.BizSolo.beans.EPFactoryBean" scope="session"></jsp:useBean>
  <jsp:useBean id="bizSite" class="com.savvion.sbm.bpmportal.bizsite.api.BizSiteBean" scope="session"></jsp:useBean>
<%! String _PageName = "Closure Audit Observation"; %>
<%! String __webAppName = "InternalAuditTechnical"; %>
<% pageContext.setAttribute( "contextPath", request.getContextPath()+"/"); %>
<% pageContext.setAttribute( "maxMultiLineLength", DatabaseMapping.self().getSQLSize(java.lang.String.class));  %>
<%java.util.List<String> priorities = com.savvion.sbm.bpmportal.util.PortalUtil.self().getPriorities();%>
<% pageContext.setAttribute( "_priorities",priorities); %>
<bizsolo:if test='<%=_PageName.equals(request.getParameter("_PageName")) %>'>
    <bizsolo:setDS name="auditStartDate,auditEndDate,branch,branchType,region,openStatusOnAuditee,sampleDoc,uploadAnnexureAuditee"></bizsolo:setDS>
    <bizsolo:choose>
<bizsolo:when test='<%=request.getParameter("bizsite_reassignTask") !=null %>'>
      <bizsolo:initDS name="performer" param="bizsite_assigneeName" hexval="FALSE"></bizsolo:initDS>
      <bizsolo:executeAction epClassName="com.savvion.BizSolo.beans.PAKReassignWI" perfMethod="commit" mode="BizSite" dsi="uploadAnnexureAuditee,sampleDoc" dso="openStatusOnAuditee,region,branchType,branch,auditEndDate,auditStartDate"></bizsolo:executeAction>
</bizsolo:when>
<bizsolo:when test='<%=request.getParameter("bizsite_saveTask") !=null %>'>
      <bizsolo:executeAction epClassName="com.savvion.BizSolo.beans.PAKUpdateDS" perfMethod="commit" mode="BizSite" dsi="openStatusOnAuditee,region,branchType,branch,auditEndDate,auditStartDate"></bizsolo:executeAction>
</bizsolo:when>
    <bizsolo:otherwise>
      <bizsolo:executeAction epClassName="com.savvion.BizSolo.beans.PAKSetDS" perfMethod="commit" mode="BizSite" dsi="openStatusOnAuditee,region,branchType,branch,auditEndDate,auditStartDate" res=""></bizsolo:executeAction>
      </bizsolo:otherwise>
    </bizsolo:choose>
<% /* Workaround, retAddr will disappear in the future */ %>
<% String retAddr = bean.getPropString("returnPage"); %>
<% if(retAddr != null) { %>
<bizsolo:redirectURL page="<%= retAddr %>"/>
<% } %>
</bizsolo:if>
<bizsolo:if test='<%= ! _PageName.equals(request.getParameter("_PageName")) %>'>
    <bizsolo:initApp mode="BizSite" name="InternalAuditTechnical"></bizsolo:initApp>
<bizsolo:initDS name="auditStartDate" type="DATETIME"></bizsolo:initDS>
<bizsolo:initDS name="auditEndDate" type="DATETIME"></bizsolo:initDS>
<bizsolo:initDS name="branch" type="STRING"></bizsolo:initDS>
<bizsolo:initDS name="branchType" type="STRING" choices="Select|Branch Office|Retail HUB Operation|Commercial HUB Operation|OD Claims|Legal Claims|Center Office"></bizsolo:initDS>
<bizsolo:initDS name="region" type="STRING"></bizsolo:initDS>
<bizsolo:initDS name="openStatusOnAuditee" type="LONG"></bizsolo:initDS>
<bizsolo:initDS name="sampleDoc" type="DOCUMENT"></bizsolo:initDS>
<bizsolo:initDS name="uploadAnnexureAuditee" type="DOCUMENT"></bizsolo:initDS>
    <bizsolo:executeAction epClassName="com.savvion.BizSolo.beans.PAKGetDS" perfMethod="commit" mode="BizSite" dso="uploadAnnexureAuditee,sampleDoc,openStatusOnAuditee,region,branchType,branch,auditEndDate,auditStartDate"></bizsolo:executeAction>
</bizsolo:if>

<title>Closure Audit Observation</title>
<%boolean isStandaloneBS = (bizManage == null || bizManage.getName() == null || "".equals(bizManage.getName()) || bizManage.getLocale() == null);Locale myLocale = (!isStandaloneBS) ? bizManage.getLocale() : request.getLocale();%>
<!-- Javascript -->
<script language="JavaScript"> var getLocalizedString = parent.getLocalizedString; </script>
<form:includes contextPath="${contextPath}"/>
<script language="JavaScript">
     
      var isIFrame = <%= (PublicResources.INTERACTIVE_MODE.equalsIgnoreCase(bean.getPropString(PublicResources.MODE)) || PublicResources.SLAVE_MODE.equalsIgnoreCase(bean.getPropString(PublicResources.MODE))) ? true : false %>;
      

    function getContextPath(){
        return "<%=request.getContextPath()%>";
    }
</script>


<sbm:setLocale value="<%= bizManage.getLocale() %>"></sbm:setLocale>
<% try{ %><sbm:setBundle scope="page" basename="InternalAuditTechnical/properties/InternalAuditTechnical"></sbm:setBundle><% } catch(Exception e){}%>
<bizsolo:getApplicationResources baseName="InternalAuditTechnical/properties/InternalAuditTechnical"/></head>
<body class="apbody yui-skin-sam" onLoad="setCheckBoxStyleForIE();hideControls();beforeInitControls();initControls();initTabs();sbm.utils.onDOMReady();">
<form method="post" name="form" onsubmit="return sbm.utils.onFormSubmit();">
<div id="northDiv" style="height:0px;display:none;"><bizsolo:xsrf/></div><% /* Workaround, activityName will disappear in the future */ %>
<% String activityName = bean.getPropString("workitemName"); %>
<div id="resultDiv">
<div style='visibility:hidden;display:none' class='vBoxClass' name='errors' id='errors'></div>
<input name="_PageName" type="hidden" value="Closure Audit Observation">
<%if(bean.getPropString("workitemName") != null) {%><input name="_WorkitemName" type="hidden" value="<%= URLHexCoder.encode(bean.getPropString("workitemName")) %>"/><input name="_WorkitemId" type="hidden" value="<%= bean.getPropLong("workitemId") %>"/><%}%>
<input name="bizsite_pagetype" type="hidden" value="activity">
<input name="_ProcessTemplateName" type="hidden" value='<%=bean.getPropString("ptName")%>'>
<input name="_yahoo_flow_button" type="hidden" value=''>
<!-- Content --> 

    
<!-- Header -->

                    <bizsolo:choose><bizsolo:when test='<%=bean.getPropString(\"workitemName\") != null %>'><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tr>
<td class="ApSegTblInBg">
<table width="100%" cellpadding="4" align="center" cellspacing="0" border="0">
<tr>

<td class="ApSegTitle" align="center"><bizsolo:choose><bizsolo:when test='<%=bean.getPropString(\"workitemName\") != null %>'><bizsolo:getDS name="workitemName"></bizsolo:getDS></bizsolo:when><bizsolo:otherwise><%=_PageName%></bizsolo:otherwise></bizsolo:choose></td>
</tr>
</table>
<table class="ApSegDataTbl" width="100%" cellspacing="1" cellpadding="4" border="0">
<tr>
<td width="15%" class="ApSegGenLabel"><bizsolo:getLabel type="RESOURCE" name="BIZSITE_INSTRUCTION_LABEL"></bizsolo:getLabel></td><td width="85%" class="ApSegGenData" colspan="5"><sbm:message key="workstep.Closure Audit Observation.instruction" escapeLine="true"></sbm:message></td>
</tr>
<tr>
<td width="15%" class="ApSegGenLabel"><bizsolo:getLabel type="RESOURCE" name="BIZSITE_PRIORITY_LABEL"></bizsolo:getLabel></td><td width="15%" class="ApSegGenData"><bizsolo:getDS name="bizsite_priority"></bizsolo:getDS></td>
<td width="15%" class="ApSegGenLabel"><bizsolo:getLabel type="RESOURCE" name="BIZSITE_STARTDATE_LABEL"></bizsolo:getLabel></td><td width="15%" class="ApSegGenData"><bizsolo:getDS name="bizsite_startDate"></bizsolo:getDS></td>
<td width="15%" class="ApSegGenLabel"><bizsolo:getLabel type="RESOURCE" name="BIZSITE_DUEDATE_LABEL"></bizsolo:getLabel></td><td width="15%" class="ApSegGenData"><bizsolo:getDS name="bizsite_dueDate"></bizsolo:getDS></td>
</tr>
</table>
</td>
</tr>
</table></bizsolo:when></bizsolo:choose>

    <link rel="stylesheet" type="text/css" href="style/commonForAudit.css" />
<link rel="stylesheet" type="text/css" href="style/style-my-tooltips.css" />

<div class="webPageContainer">
<div class="header">
 Closure of Audit Observations
</div>

<%
  com.rel.techaudit.utilities.TechnicalAuditUtility customUtility = new com.rel.techaudit.utilities.TechnicalAuditUtility();
%>

<script type="text/javascript" src="script/jquery-1.10.2.js"></script>     
<script type="text/javascript" src="script/jquery.style-my-tooltips.js"></script>     
<script type="text/javascript" src="script/commonJS.js"></script>

<script>


  var allDynamicCreatedTableIds;
  var btnObj;

<%   
 String piid = activityName.split("#")[1].split("::")[0];
 String workStepName = activityName.split("::")[1];
 String region = bean.getPropString("region");
 String branch = bean.getPropString("branch");
%>        

$(document).ready(function()
{
    pwr.retrieveSavedData('<%= piid %>','<%= workStepName %>',callBackRetrieveSavedData);
});

function callBackRetrieveSavedData(auditData)
{
    var duplictPrmtrs = [];
    for(var i = 0; i < auditData.length; i++ )
    {
	duplictPrmtrs.push(auditData[i].PARAMETER_VALUE);
    }
    prmtrs = duplictPrmtrs.unique();
    allDynamicCreatedTableIds = prmtrs;
    createMap(auditData);
    for(var i = 0; i < prmtrs.length; i++)
    {   
	var methodOutput = 'showClickedParameterDataTable(\''+prmtrs[i]+'\')';
	createDynamicHyperlink("_"+prmtrs[i],methodOutput,prmtrs[i],"parameterLinkContainerId");    
	createDymamicTableHead(prmtrs[i],columnNames('AuditClosurePage','<%= bean.getPropString("branchType") %>'),"dynamicCreatedTableContainerId","dynamicTableTH1");
	createDynamicTableBody(prmtrs[i],prmtr_sbprmtrMap[prmtrs[i]],columnNames('AuditClosurePage','<%= bean.getPropString("branchType") %>'));
	setValuesToFields(prmtrs[i],auditData);
    }
    showClickedParameterDataTable(prmtrs[0]);
 
}


function createDynamicTableBody(parameterValue,subParameterValue,parameterWiseTableHeaderList)
{
     var tableObj = document.getElementById(parameterValue);
     var tableBodyObj = document.createElement('tbody');
     tableObj.appendChild(tableBodyObj);
     var tableTbodyObj = tableObj.getElementsByTagName("tbody")[0];
     for(var i=0;i<subParameterValue.length;i++)
     {
         var tableRowObj = tableTbodyObj.insertRow(i);
         var isValueEven = isEven(i);
         if(isValueEven == true)
         {
             tableRowObj.className = "evenRowStyle";                   
     	 }else
     	 {
     	     tableRowObj.className = "oddRowStyle";                        
     	 }
         for(var j=0;j<parameterWiseTableHeaderList.length;j++)
         {  
     	     var tableRowCellObj = tableRowObj.insertCell(j);
     	     tableRowCellObj.className = "dynamicTableCell";
     	     if(parameterWiseTableHeaderList[j] == "POM NO")
     	     {
     		 tableRowCellObj.innerHTML = (i+1);                             
     	     }
     	     else if(parameterWiseTableHeaderList[j] == "PARAMETER")
     	     {
     		 tableRowCellObj.innerHTML = parameterValue;
     		 setValueInTitle(tableRowCellObj,parameterValue);
     	     }
     	     else if(parameterWiseTableHeaderList[j] == "SUB PARAMETER")
     	     {
     		 tableRowCellObj.innerHTML = subParameterValue[i];
     		 setValueInTitle(tableRowCellObj,subParameterValue[i]);
     	     }
     	     else if(parameterWiseTableHeaderList[j] == "AUDITOR STATUS")
     	     {
     	  	  tableRowCellObj.innerHTML = "<select class='ApInptSelect'><option value='Open'>Open</option><option value='Close'>Close</option></select>";
     	     }
     	     else
     	     {
     		 tableRowCellObj.innerHTML = "<input type='text' onmouseover='getValueOfField(this);' onClick='remarkbox_open(this);' size='5' />";
     	     }
         }
    }
}


var dataRowCnt = 0;             
function setValuesToFields(tableId,auditData)
{       
     var rows = document.getElementById(tableId).getElementsByTagName('tbody')[0].getElementsByTagName('tr').length;
     var clmns = columnNames('AuditClosurePage','<%= bean.getPropString("branchType") %>');
     for(var j=0;j<rows;j++)
     {
          var rowObj = document.getElementById(tableId).getElementsByTagName('tbody')[0].getElementsByTagName('tr')[j];
          for(var k=0;k<clmns.length;k++)
          {
              if(clmns[k] == 'POM NO' || clmns[k] == 'SUB PARAMETER' || clmns[k] == 'PARAMETER')
              { 
                  continue;
              }
              else if(clmns[k] == 'RISK RATE')
              {
                  var riskRateValue = riskRateValMapping(auditData[dataRowCnt].RISK_RATE);
                  if(riskRateValue == "" || riskRateValue == "null" || riskRateValue == null || riskRateValue == "Select")
                  {
                       riskRateValue = "";
                  }
		  rowObj.getElementsByTagName('td')[k].innerHTML = ellipsify(riskRateValue.split('-')[1]);
		  if(riskRateValue != "Select")
		  {
		       rowObj.getElementsByTagName('td')[k].style.backgroundColor = '#5e5e5e';
		       rowObj.getElementsByTagName('td')[k].style.color = riskRateColorMapp(riskRateValue.split('-')[0]).split('-')[1];
		  }
                 setValueInTitle(rowObj.getElementsByTagName('td')[k],riskRateValue.split('-')[1]);
              }
              else if(clmns[k] == 'DEPARTMENT' || clmns[k] == 'CLASS' || clmns[k] == 'COURT TYPE' || clmns[k] == 'LOSS NATURE' || clmns[k] == 'CLAIM STATUS' || clmns[k] == 'CLAIM CATEGORY' || clmns[k] == 'SETTLEMENT BASIS' || clmns[k] == 'DOCUMENT NO / ANNEXURE REF NO' || clmns[k] == 'AUDIT OBSERVATION' || clmns[k] == 'RISK IMPACT' || clmns[k] == 'RECOMMENDATION' || clmns[k] == 'CORRECTIVE PREVENTIVE ACTION' || clmns[k] == 'TIMELINE RESOLUTION' || clmns[k] == 'REASON FOR DEVIATION' || clmns[k] == 'AUDITEE STATUS')
              {
                   var val = "";
                   if(clmns[k] == 'DEPARTMENT')
		   {
		       val = auditData[dataRowCnt].DEPARTMENT;
		   }
		   else if(clmns[k] == 'CLASS')
		   {
		       val = auditData[dataRowCnt].CLASS;
		   }
		   else if(clmns[k] == 'COURT TYPE')
		   {
		       val = auditData[dataRowCnt].COURT_TYPE;
		   }
		   else if(clmns[k] == 'LOSS NATURE')
		   {
		       val = auditData[dataRowCnt].LOSS_NATURE;
		   }
		   else if(clmns[k] == 'CLAIM STATUS')
		   {
		       val = auditData[dataRowCnt].CLAIM_STATUS;
		   }
		   else if(clmns[k] == 'CLAIM CATEGORY')
		   {
		       val = auditData[dataRowCnt].CLAIM_CATEGORY;
		   }
		   else if(clmns[k] == 'SETTLEMENT BASIS')
		   {
		       val = auditData[dataRowCnt].SETTLEMENT_BASIS;
                   }
                   else if(clmns[k] == 'DOCUMENT NO / ANNEXURE REF NO')
                   {                    
                        val = auditData[dataRowCnt].DOCUMENTNO;
                   }
                   else if(clmns[k] == 'AUDIT OBSERVATION')
                   {
                        val = auditData[dataRowCnt].MIDDLE_PARA;
                   }
                   else if(clmns[k] == 'RISK IMPACT')
                   {
                        val = auditData[dataRowCnt].LAST_PARA;
                   }
                   else if(clmns[k] == 'RECOMMENDATION')
                   {
                        val = auditData[dataRowCnt].RECOMMENDATION;
                   }
                   else if(clmns[k] == 'REASON FOR DEVIATION')
		   {
		       val = auditData[dataRowCnt].REASON_FOR_DEVIATION;
		   }
		   else if(clmns[k] == 'TIMELINE RESOLUTION')
		   {
		       val = auditData[dataRowCnt].TIMELINE_RESOLUTION;
		   }
		   else if(clmns[k] == 'CORRECTIVE PREVENTIVE ACTION')
		   {
		       val = auditData[dataRowCnt].CORRECTIVE_PREVENTIVE_ACTION;
                   }
                   else if(clmns[k] == 'AUDITEE STATUS')
		   {
		       val = auditData[dataRowCnt].STATUS_BY_AUDITEE;
                   }
                   if(val == null || val == " " || val == "" || val == "Select" || val == "null")
                   {
                       val = "";
                   }
                   rowObj.getElementsByTagName('td')[k].innerHTML = ellipsify(val);
		   rowObj.getElementsByTagName('td')[k].onclick = (function(){
		        getValInPopupClosure($(this).parent().parent().parent());  
		   });
                   setValueInTitle(rowObj.getElementsByTagName('td')[k],val);
              }
              else if(clmns[k] == 'REMARKS BY AUDITOR')
              { 
                  var value = auditData[dataRowCnt].REMARKS;
                  if(value == null || value == 'null' || value == ' ')
                  {
                      value = "";
                  }
                  rowObj.getElementsByTagName('td')[k].getElementsByTagName('input')[0].value = value;             
              }
              else if(clmns[k] == 'AUDITOR STATUS')
              {
                  rowObj.getElementsByTagName('td')[k].getElementsByTagName('select')[0].value = auditData[dataRowCnt].STATUS_BY_AUDITOR;
              }
          }
          dataRowCnt += 1;
      }
}



function saveReport(prmtrs,obj)
{
    btnObj = obj;
    if(btnObj.value == "Submit")
    {
        if(remarksValidation())
        {}
        else
        {
            return false;
        }
    }
    var arrByRowData = new Array(); 
    var arrOfAllTableRowData = new Array();
    var arrayOfArrayOfColumnsData = new Array();
    for(var i=0;i<prmtrs.length;i++)
    {
 	var noOfRowsInTbody = document.getElementById(prmtrs[i]).getElementsByTagName('tbody')[0].getElementsByTagName('tr').length;
 	for(var j=0;j<noOfRowsInTbody;j++)
 	{
 	    arrByRowData[j] = new Array();
 	    var rowObj = document.getElementById(prmtrs[i]).getElementsByTagName('tbody')[0].getElementsByTagName('tr')[j];
 	    if(rowObj.cells.length == 19)
 	    {
 	        for(var k=1;k<rowObj.cells.length;k++)
		{
		    if(k==18)
		    {
		        var obj = rowObj.getElementsByTagName('td')[k].getElementsByTagName('select')[0];
		     	arrByRowData[j][k-1] = obj.options[obj.selectedIndex].value;
		    }
		    else if(k>=1 && k<=16)
		    {
		        arrByRowData[j][k-1] = rowObj.getElementsByTagName('td')[k].title;
		    }
		    else
		    {
		        var temp = rowObj.getElementsByTagName('td')[k].getElementsByTagName('input')[0].value;
		     	if(temp == "")
		     	{
		     	    temp = " ";
		     	}
		     	arrByRowData[j][k-1] = temp;
		    }
                }
 	    }
 	    else
 	    {
 	         for(var k=1;k<rowObj.cells.length;k++)
		 {
		     if(k==15)
		     {
		         var obj = rowObj.getElementsByTagName('td')[k].getElementsByTagName('select')[0];
		     	 arrByRowData[j][k-1] = obj.options[obj.selectedIndex].value;
		     }
		     else if(k>=1 && k<=13)
		     {
		     	 arrByRowData[j][k-1] = rowObj.getElementsByTagName('td')[k].title;
		     }
		     else
		     {
		     	 var temp = rowObj.getElementsByTagName('td')[k].getElementsByTagName('input')[0].value;
		     	 if(temp == "")
		     	 {
		     	     temp = " ";
		     	 }
		     	 arrByRowData[j][k-1] = temp;
		     }
                 }
 	    }
        } 
        arrOfAllTableRowData[i] = arrByRowData;
        arrByRowData = [];
    }  
    var count = 0;
    for(var n=0;n<arrOfAllTableRowData.length;n++)
    {
        for(var o=0;o<arrOfAllTableRowData[n].length;o++)
        {
            for(var p=0;p<arrOfAllTableRowData[n][o].length;p++)
            {
 	        if(n == 0 && o == 0)
	        {
    	            arrayOfArrayOfColumnsData[p] = new Array();
  	        }
  	        arrayOfArrayOfColumnsData[p][count] = arrOfAllTableRowData[n][o][p]; 
            } 
            count++;
        }
    }
    document.getElementById('comboBox2').value = '<%= bean.getPropString("branchType") %>';
    pwr.updateInitialSelectedDataByAuditor('<%= piid %>',arrayOfArrayOfColumnsData,'<%= workStepName %>','<%= bean.getPropString("branchType") %>',callbackSaveAuditorReport); 
}


function callbackSaveAuditorReport(value){}


function savingInfoEnd()
{
    savingMsg.hide();
    if(btnObj.value == "Submit")
    {
         pwr.getOpenStatusOnAuditeeWS('<%= piid %>',callbackOpenStatusOnAuditeeWS);
    }  
}

function callbackOpenStatusOnAuditeeWS(value)
{
    document.getElementById('openStatus').value = value;
    document.getElementById('completeWS').click();
}

function remarksValidation()
{
    for(var i=0;i<prmtrs.length;i++)
    {
        var tabObj = document.getElementById(prmtrs[i]);
        var noOfRowsInTbody = tabObj.getElementsByTagName('tbody')[0].getElementsByTagName('tr').length;
        for(var j=0;j<noOfRowsInTbody;j++)
        {   
            var auditorstatusCellObj;
            var remarksCellObj;
            var rowObj = tabObj.getElementsByTagName('tbody')[0].getElementsByTagName('tr')[j];
    	    var paramCellObj = rowObj.getElementsByTagName('td')[1].title;
    	    if(rowObj.cells.length == 19)
    	    {
    	        auditorstatusCellObj = rowObj.getElementsByTagName('td')[18].getElementsByTagName('select')[0];
    	        remarksCellObj = rowObj.getElementsByTagName('td')[17].getElementsByTagName('input')[0];
    	    }
    	    else
    	    {
                auditorstatusCellObj = rowObj.getElementsByTagName('td')[15].getElementsByTagName('select')[0];
    	        remarksCellObj = rowObj.getElementsByTagName('td')[14].getElementsByTagName('input')[0];    	    
    	    } 
    	    if($(auditorstatusCellObj).val() == "Open" && ($(remarksCellObj).val() == "" || $(remarksCellObj).val() == null))
    	    {
       		if(tabObj.style.display == "none")
       		{
       		    document.getElementById("_"+paramCellObj).click();
         	    document.getElementById("_"+paramCellObj).childNodes[0].click();
         	    remarksCellObj.click();
                    return false;
       		}
       		else
       		{
         	    remarksCellObj.click();
         	    return false;
        	}	
       	   }
       }
   }
   return true;
}

</script>

<div id="parameterLinkContainerId" class="parameterLinkContainerStyle"></div>
<div id="dynamicCreatedTableContainerId"></div>
<table id="scheduledAuditInfo" width="100%" name="scheduledAuditInfo">
<tr>
 <th>Region</th>
 <th>Audit Type</th>
 <th>Location Name</th>
 <th>Audit Start Date</th>
 <th>Audit End Date</th>
</tr>
<tr>
 <td><%= bean.getPropString("region") %></td>
 <td><%= bean.getPropString("branchType")+" Audit" %></td>
 <td><%= bean.getPropString("branch") %></td>
 <td><%= customUtility.getDateWithFormate(bean.getPropDate("auditStartDate")) %></td>
 <td><%= customUtility.getDateWithFormate(bean.getPropDate("auditEndDate")) %></td>
</tr>
</table>
<div class="light" id='valPp'></div>
<div class="uploadDivStl" onclick="document.getElementById('sampleDoc').click();">
   <img src="images/index.jpg" height="20" width="120" /><br />
    View Sample Document.
</div>
<div class="uploadDivStl" onclick="document.getElementById('uploadAnnexureAuditee').click();">
  <img src="images/index.jpg" height="20" width="120" /><br />
   View Auditee Annexure.
</div>
<div class="uploadDivStl" onClick="openAuditHistory('AuditHistory.jsp?piid=<%=piid%>');">
  <img src="images/index.jpg" height="20" width="120" /><br />
   View Audit History.
</div>
<div style="display:none;" class="uploadDivStl" onClick="openAuditHistory('StatisticalAnalysisReports.jsp?piid=<%=piid%>');">
  <img src="images/index.jpg" height="20" width="120" /><br />
   View Analysis Report.
</div>
<style>
 table{
  border:2px solid white;
  border-collapse:collapse;
  }
  table td
  {
    border:1px solid white;
    border-collapse:collapse;
    text-align : center;
    background-color:#D2E0F1;
  }
  table th
    {
      border:1px solid white;
      border-collapse:collapse;
  }
</style>
<div class="saveSubmitContainer">
<div id="SaveWorkingContainer" class="saveButtonStyle"><input type="button" style="width:150px;" class="ApScrnButton" id="saveReportBtn" value="Save" onClick="saveReport(allDynamicCreatedTableIds,this);" /></div>
<div id="SubmitWorkingContainer" class="submitButtonStyle"><input type="button" style="width:150px;" class="ApScrnButton" value="Submit" onClick="saveReport(allDynamicCreatedTableIds,this);" /></div>
</div>
<div id="remarkPopup">
   <table>
     <tr>
       <td>Remarks :</td>
       <td><textarea cols='30' onkeyup='wordLimiter(this);' id='remarksTextArea' rows='3'></textarea></td>
     </tr>
     <tr>
       <td colspan="2"><div onClick='setValuesInFieldsClosure();' class='popupBtn' >OK</div></td>
     </tr>
   </table>
  <a href="#" class="cancel" onClick="remarkbox_close();"></a>
</div>
<div id="fade"></div> 
</div>
<div style="display:none;">
    <br clear="all">
<br clear="all">
Audit Start Date:<sfe:widget name="form.datetime" id="dateTime2" args="{'dateonly':false, 'visible':true, 'readonly':false, 'validationType':'none', 'validation':{}, 'toolTip':'', 'tabOrder':'0'}" />

    <br clear="all">
Audit End Date:<sfe:widget name="form.datetime" id="dateTime1" args="{'dateonly':false, 'visible':true, 'readonly':false, 'validationType':'none', 'validation':{}, 'toolTip':'', 'tabOrder':'0'}" />

    <br clear="all">
Branch:<sfe:widget name="sbm.combobox" id="comboBox1" args="{'size':20, 'readonly':false, 'visible':true, 'disabled':false, 'cascade':false, 'level':0, 'validationType':'none', 'validation':{}, 'toolTip':'', 'tabOrder':'0'}" />

    <br clear="all">
<Label class="" id="" for="comboBox2"><sbm:message key="branchType"></sbm:message></Label>
    <sfe:widget name="sbm.combobox" id="comboBox2" args="{'size':20, 'readonly':false, 'visible':true, 'disabled':false, 'cascade':false, 'level':0, 'validationType':'none', 'validation':{}, 'toolTip':'', 'tabOrder':'0'}" value="[{'selected':false,'value':'Select','label':'Select'},{'selected':false,'value':'Branch Office','label':'Branch Audit'},{'selected':false,'value':'Retail HUB Operation','label':'Retail HUB Operation'},{'selected':false,'value':'Commercial HUB Operation','label':'Commercial HUB Operation'},{'selected':false,'value':'OD Claims','label':'OD Claims'},{'selected':false,'value':'Legal Claims','label':'Legal Claims'},{'selected':false,'value':'Center Office','label':'Service Center Audit'}]" />

    <br clear="all">
<br clear="all">
Regio<sfe:widget name="sbm.combobox" id="comboBox3" args="{'size':20, 'readonly':false, 'visible':true, 'disabled':false, 'cascade':false, 'level':0, 'validationType':'none', 'validation':{}, 'toolTip':'', 'tabOrder':'0'}" />

    <br clear="all">
Open Status O<Label class="" id="" for="textField1"><sbm:message key="openStatusOnAuditee"></sbm:message></Label>Auditee:<sfe:widget name="sbm.textfield" id="openStatus" args="{'type':'text', 'size':30, 'maxlength':256, 'readonly':false, 'visible':true, 'disabled':false, 'validationType':'none', 'validation':{}, 'toolTip':'', 'tabOrder':'0'}" />

    <br clear="all">
Sample Doc:<div style="display: inline;" id="document2"><bizsolo:getDS type="field" name="sampleDoc" multiline="true" wsName="Closure Audit Observation" appendWith="false" writePerm="false"></bizsolo:getDS></div>


    <br clear="all">
Upload Annexure Auditee:<div style="display: inline;" id="document1"><bizsolo:getDS type="field" name="uploadAnnexureAuditee" multiline="true" wsName="Closure Audit Observation" appendWith="false" writePerm="false"></bizsolo:getDS></div>


    <br clear="all">
<input class="ApScrnButton" name="bizsite_completeTask" id="completeWS" type="submit" tabindex="0" value="<bizsolo:getLabel name='COMPLETE_LABEL' type='RESOURCE'/>" onMouseOut="this.className='ApScrnButton';" onMouseOver="this.className='ApScrnButtonHover';" onClick="clickedButton=this.name;this.onsubmit = new Function('return false');">

    <br clear="all">
</div>
    

</div>
<!-- Footer -->

<div id="cmdDiv" style="height:46px;">
<table width="100%" height="100%" cellpadding="0" align="center" cellspacing="0" border="0">
<tr align="center">
<td class="ApButtonDarkBg" width="63%">
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td class="ApBtnSpace">
<bizsolo:isNotSuspended><form:button id="bizsite_completeTask" name="bizsite_completeTask" link="COMPLETE_LABEL" resourceType="RESOURCE"/> </bizsolo:isNotSuspended></td>
<td class="ApBtnSpace">
<form:button id="bizsite_saveTask" name="bizsite_saveTask" link="SAVE_LABEL" resourceType="RESOURCE"/> </td>
<bizsolo:isAssigned></bizsolo:isAssigned><td class="ApBtnSpace">
<form:button id="bizsite_reset" name="bizsite_reset" link="RESET_LABEL" onclick="sbm.utils.reset" resourceType="RESOURCE"/> </td>
<td class="ApBtnSpace">
<form:button id="btn-cancel" name="btn-cancel" link="CANCEL_LABEL" onclick="sbm.utils.cancel" resourceType="RESOURCE"/> </td>
<bizsolo:isAssigned><td class="ApBtnSpace"><input class="ApInptTxt" type="text" name="bizsite_assigneeName" size="20"></td><td class="ApBtnSpace"><a href="javascript://" onClick="setUserControl(document.form.bizsite_assigneeName);searchUser()"><img width="16" height="16" border="0" title="Search" src="<c:out value='${contextPath}'/>bpmportal/css/app<%= bizManage.getTheme() %>/images/icon_edit_user_search_single.gif"></img></a></td><td class="ApBtnSpace"><form:button id="bizsite_reassignTask" name="bizsite_reassignTask" link="REASSIGN_LABEL" resourceType="RESOURCE"/> </td>
</bizsolo:isAssigned></tr>
</table>
</td>
</tr>
</table>
</div>

  
                    <div id="resizablepanel" style="display:none">
                        <div class="hd">Alert Dialog</div>
                        <div class="bd"></div>
                        <div class="ft"></div>
                    </div> 
<div id="southDiv" style="height:0px;display:none;"></div></form>
</body>

<script language="JavaScript">
<!--
function beforeInitControls() {
}
-->
</script>
<script language="JavaScript">
<!--
function userValidationJavascript() {
return true;
}
-->
</script>
<sbm:dataSources appName="InternalAuditTechnical" appType="bizlogic">
</sbm:dataSources>
<script language="JavaScript">
<!---->
</script>
<!--Initialize extensible widgets.-->
<script language="JavaScript">
<!--
var _dateFormats = {date:'<%=bean.getPropString(PublicResources.JS_CALENDAR_DATE_FORMAT)%>', dateOnly:'<%=bean.getPropString(PublicResources.JS_CALENDAR_DATE_ONLY_FORMAT)%>'};

var allWidgets = [{widget:'dateTime2', bound:'true', editable:'true', type:'form.datetime', source: {type:'DATASLOT', dataSlotName:'auditStartDate', dataSlotType:'DATETIME'}, target:{type:'DATASLOT', dataSlotName:'auditStartDate', dataSlotType:'DATETIME'}, dsType:'DATETIME', service:'false'},
{widget:'dateTime1', bound:'true', editable:'true', type:'form.datetime', source: {type:'DATASLOT', dataSlotName:'auditEndDate', dataSlotType:'DATETIME'}, target:{type:'DATASLOT', dataSlotName:'auditEndDate', dataSlotType:'DATETIME'}, dsType:'DATETIME', service:'false'},
{widget:'comboBox1', bound:'true', editable:'true', type:'sbm.combobox', source: {type:'DATASLOT', dataSlotName:'branch', dataSlotType:'STRING'}, target:{type:'DATASLOT', dataSlotName:'branch', dataSlotType:'STRING'}, dsType:'STRING', service:'false'},
{widget:'comboBox2', bound:'true', editable:'true', type:'sbm.combobox', source: {type:'STATIC'}, target:{type:'DATASLOT', dataSlotName:'branchType', dataSlotType:'STRING'}, dsType:'STRING', service:'false'},
{widget:'comboBox3', bound:'true', editable:'true', type:'sbm.combobox', source: {type:'DATASLOT', dataSlotName:'region', dataSlotType:'STRING'}, target:{type:'DATASLOT', dataSlotName:'region', dataSlotType:'STRING'}, dsType:'STRING', service:'false'},
{widget:'openStatus', bound:'true', editable:'true', type:'sbm.textfield', source: {type:'DATASLOT', dataSlotName:'openStatusOnAuditee', dataSlotType:'LONG'}, target:{type:'DATASLOT', dataSlotName:'openStatusOnAuditee', dataSlotType:'LONG'}, dsType:'LONG', service:'false'}
];
var businessObjects = [];
var formWidgetHandler;

sbm.utils.onDOMReady = function() {
YAHOO.util.Event.onDOMReady(function(){
formWidgetHandler = new FormWidgetHandler(allWidgets,null,{processName:'InternalAuditTechnical',processType:'bizlogic',maxMultiLineLength:${maxMultiLineLength},adapletCache:{'user':''}},'<%=request.getParameter(BizSoloRequest.BSS_FIID)%>');
 });
 }
Ext.onReady(function(){
 var task = new Ext.util.DelayedTask(function(){
});
  task.delay(500);
  var viewport = new Bm.util.BmViewport('',{resultComponentXtype:'container'});

});

   
    scrollToErrors = function() {
        var errorsDiv = document.getElementById('errors');
        if(errorsDiv !== null) {
            errorsDiv.scrollIntoView();
        }
    }
    sbm.utils.onFormSubmit = function() {
        if(!formWidgetHandler.validateWidgets()) {
            scrollToErrors();
            return false;
        }
        try{
            if(!userValidationJavascript()) {
                scrollToErrors();
                return false;
            }              
            sbm.utils.handleFormSubmit();
        }catch(e){
            scrollToErrors();
            return false;
        }

                            document.form.action='<%=response.encodeURL("ClosureAuditObservation.jsp")%>';
         if(allWidgets.length > 0)formWidgetHandler.saveDataSlots();
         return true;
}
-->
</script>

</html>