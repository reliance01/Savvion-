<%--  This JSP has been generated by using from xsl version 9.0 at Wed Mar 09 17:54:13 IST 2022 --%>
<!DOCTYPE html>
<html xmlns:sbm="http://www.savvion.com/sbm" xmlns:bizsolo="http://www.savvion.com/sbm/BizSolo" xmlns:jsp="http://java.sun.com/JSP/Page" xmlns:xalan="http://xml.apache.org/xalan" xmlns:fn="http://www.w3.org/2005/02/xpath-functions" xmlns:sfe="http://www.savvion.com/sbm/sfe" xmlns:c="http://java.sun.com/jsp/jstl/core">
<head><META http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge">

<%@ page contentType="text/html; charset=UTF-8" %>
<%@ page import="com.savvion.BizSolo.Server.*,com.savvion.BizSolo.beans.*,com.savvion.sbm.util.DatabaseMapping,java.util.Vector,java.util.Locale" %>
<%@ page import="com.savvion.sbm.bizsolo.util.session.*,java.net.*" %>
<%@ page errorPage="/BizSolo/common/jsp/expcontroller.jsp" %>
<%@ taglib uri="/BizSolo/common/tlds/bizsolo.tld" prefix="bizsolo" %>
<%@ taglib uri="/bpmportal/tld/bpmportal.tld" prefix="sbm" %>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<%@ taglib uri="http://java.sun.com/jsp/jstl/fmt" prefix="fmt" %>
<%@ taglib prefix="form" tagdir="/WEB-INF/tags/form"%>
<%@ taglib prefix="sfe" uri="http://jmaki/v1.0/jsp" %>
  <jsp:useBean id="bizManage" class="com.savvion.sbm.bizmanage.api.BizManageBean" scope="session"></jsp:useBean>
  <jsp:useBean id="bean" class="com.savvion.BizSolo.beans.Bean" scope="session"></jsp:useBean>
  <jsp:useBean id="factoryBean" class="com.savvion.BizSolo.beans.EPFactoryBean" scope="session"></jsp:useBean>
  <jsp:useBean id="bizSite" class="com.savvion.sbm.bpmportal.bizsite.api.BizSiteBean" scope="session"></jsp:useBean>
<%! String _PageName = "Start"; %>
<%! String __webAppName = "InternalAuditTechnical"; %>
<% pageContext.setAttribute( "contextPath", request.getContextPath()+"/"); %>
<% pageContext.setAttribute( "maxMultiLineLength", DatabaseMapping.self().getSQLSize(java.lang.String.class));  %>
<%java.util.List<String> priorities = com.savvion.sbm.bpmportal.util.PortalUtil.self().getPriorities();%>
<% pageContext.setAttribute( "_priorities",priorities); %>
<bizsolo:if test='<%=_PageName.equals(request.getParameter("_PageName")) %>'>
    <bizsolo:setDS name="branchType,region,branch,RH,BSM,auditor,zonalHead,ECRGHead,auditStartDate,auditEndDate,sampleDoc,auditeeUserName,auditor_username,auditeeMailId,auditeeMailSubject,auditeeMessage,othersMailId"></bizsolo:setDS>
    <bizsolo:setDS name="bizsite_instanceName,bizsite_priority"></bizsolo:setDS>
    <bizsolo:executeAction epClassName="com.savvion.BizSolo.beans.PAKCreatePI" perfMethod="commit" mode="BizSite" dsi="auditor,othersMailId,auditeeMessage,auditeeMailSubject,auditeeMailId,auditor_username,auditeeUserName,sampleDoc,auditEndDate,auditStartDate,ECRGHead,zonalHead,BSM,RH,branch,region,branchType"></bizsolo:executeAction>
<% /* Workaround, retAddr will disappear in the future */ %>
<% String retAddr = bean.getPropString("returnPage"); %>
<% if(retAddr != null) { %>
<bizsolo:redirectURL page="<%= retAddr %>"/>
<% } %>
</bizsolo:if>
<bizsolo:if test='<%= ! _PageName.equals(request.getParameter("_PageName")) %>'>
    <bizsolo:initApp mode="BizSite" name="InternalAuditTechnical" refresh="true"></bizsolo:initApp>
    <bizsolo:initDS name="bizsite_instruction"></bizsolo:initDS>
    <bizsolo:initDS name="bizsite_priority" hexval="FALSE"></bizsolo:initDS>
    <bizsolo:initDS name="bizsite_instanceName" hexval="FALSE"></bizsolo:initDS>
<bizsolo:initDS name="branchType" type="STRING" choices="Select|Branch Office|Retail HUB Operation|Commercial HUB Operation|OD Claims|Legal Claims|Center Office"></bizsolo:initDS>
<bizsolo:initDS name="region" type="STRING"></bizsolo:initDS>
<bizsolo:initDS name="branch" type="STRING"></bizsolo:initDS>
<bizsolo:initDS name="RH" type="STRING"></bizsolo:initDS>
<bizsolo:initDS name="BSM" type="STRING"></bizsolo:initDS>
<bizsolo:initDS name="auditor" type="STRING"></bizsolo:initDS>
<bizsolo:initDS name="zonalHead" type="STRING"></bizsolo:initDS>
<bizsolo:initDS name="ECRGHead" type="STRING"></bizsolo:initDS>
<bizsolo:initDS name="auditStartDate" type="DATETIME"></bizsolo:initDS>
<bizsolo:initDS name="auditEndDate" type="DATETIME"></bizsolo:initDS>
<bizsolo:initDS name="sampleDoc" type="DOCUMENT"></bizsolo:initDS>
<bizsolo:initDS name="auditeeUserName" type="STRING"></bizsolo:initDS>
<bizsolo:initDS name="auditor_username" type="STRING"></bizsolo:initDS>
<bizsolo:initDS name="auditeeMailId" type="STRING"></bizsolo:initDS>
<bizsolo:initDS name="auditeeMailSubject" type="STRING"></bizsolo:initDS>
<bizsolo:initDS name="auditeeMessage" type="STRING"></bizsolo:initDS>
<bizsolo:initDS name="othersMailId" type="STRING"></bizsolo:initDS>
    <bizsolo:executeAction epClassName="com.savvion.BizSolo.beans.PAKGetDS" perfMethod="commit" mode="BizSite" dso="auditor,othersMailId,auditeeMessage,auditeeMailSubject,auditeeMailId,auditor_username,auditeeUserName,sampleDoc,auditEndDate,auditStartDate,ECRGHead,zonalHead,BSM,RH,branch,region,branchType"></bizsolo:executeAction>
</bizsolo:if>

<title>Start</title>
<%boolean isStandaloneBS = (bizManage == null || bizManage.getName() == null || "".equals(bizManage.getName()) || bizManage.getLocale() == null);Locale myLocale = (!isStandaloneBS) ? bizManage.getLocale() : request.getLocale();%>
<!-- Javascript -->
<script language="JavaScript"> var getLocalizedString = parent.getLocalizedString; </script>
<form:includes contextPath="${contextPath}"/>
<script language="JavaScript">
     
      var isIFrame = <%= (PublicResources.INTERACTIVE_MODE.equalsIgnoreCase(bean.getPropString(PublicResources.MODE)) || PublicResources.SLAVE_MODE.equalsIgnoreCase(bean.getPropString(PublicResources.MODE))) ? true : false %>;
      

    function getContextPath(){
        return "<%=request.getContextPath()%>";
    }
</script>


<sbm:setLocale value="<%= bizManage.getLocale() %>"></sbm:setLocale>
<% try{ %><sbm:setBundle scope="page" basename="InternalAuditTechnical/properties/InternalAuditTechnical"></sbm:setBundle><% } catch(Exception e){}%>
<bizsolo:getApplicationResources baseName="InternalAuditTechnical/properties/InternalAuditTechnical"/></head>
<body class="apbody yui-skin-sam" onLoad="setCheckBoxStyleForIE();hideControls();beforeInitControls();initControls();initTabs();sbm.utils.onDOMReady();">
<form method="post" name="form" onsubmit="return sbm.utils.onFormSubmit();">
<div id="northDiv" style="height:0px;display:none;"><bizsolo:xsrf/></div><% /* Workaround, activityName will disappear in the future */ %>
<% String activityName = bean.getPropString("workitemName"); %>
<div id="resultDiv">
<div style='visibility:hidden;display:none' class='vBoxClass' name='errors' id='errors'></div>
<input name="_PageName" type="hidden" value="Start">
<%if(bean.getPropString("workitemName") != null) {%><input name="_WorkitemName" type="hidden" value="<%= URLHexCoder.encode(bean.getPropString("workitemName")) %>"/><input name="_WorkitemId" type="hidden" value="<%= bean.getPropLong("workitemId") %>"/><%}%>
<input name="bizsite_pagetype" type="hidden" value="start">
<input name="_ProcessTemplateName" type="hidden" value='<%=bean.getPropString("ptName")%>'>
<input name="_yahoo_flow_button" type="hidden" value=''>
<!-- Content --> 

    
<!-- Header -->
<table width="100%" cellspacing="0" cellpadding="0" border="0">
<tr>
<td class="ApSegTblInBg">
<table border="0" cellspacing="0" align="center" cellpadding="4" width="100%">
<tr align="center">
<td class="ApSegTitle" style="border-top:0px;"><bizsolo:getLabel type="RESOURCE" name="processTemplateLabel_"></bizsolo:getLabel></td>
</tr></table>
<table border="0" cellspacing="1" align="center" cellpadding="4" width="100%" class="ApSegDataTbl">
<tr border="1" align="center">
<td border="1" width="15%" class="ApSegGenLabel"><bizsolo:getLabel type="RESOURCE" name="BIZSITE_INSTANCE_NAME_LABEL"></bizsolo:getLabel></td>
<td border="1" width="55%" class="ApSegGenData"><input name="bizsite_instanceName" size="30" maxlength="240" type="text" class="ApInptTxt"><script>addValue("bizsite_instanceName", "<bizsolo:getLabel type='RESOURCE' name='processTemplateLabel_'/>");</script></td>
<td border="1" width="15%" class="ApSegGenLabel"><bizsolo:getLabel type="RESOURCE" name="BIZSITE_PRIORITY_LABEL"></bizsolo:getLabel></td>
<td border="1" width="15%" class="ApSegGenData"><select name="bizsite_priority" id="bizsite_priority" class="ApInptSelect"><c:forEach var="priority" items="${_priorities}"> <option value="${priority}"> <c:choose><c:when test="${priority == 'critical'}"><bizsolo:getLabel type="RESOURCE" name="PRIORITY_CRITICAL"/></c:when><c:when test="${priority == 'high'}"><bizsolo:getLabel type="RESOURCE" name="PRIORITY_HIGH"/></c:when><c:when test="${priority == 'medium'}"><bizsolo:getLabel type="RESOURCE" name="PRIORITY_MEDIUM"/></c:when><c:when test="${priority == 'low'}"><bizsolo:getLabel type="RESOURCE" name="PRIORITY_LOW"/></c:when>    </c:choose>    </option>        </c:forEach>  </select></td>
</tr>
<tr><td border="1" width="15%" class="ApSegGenLabel"><bizsolo:getLabel type="RESOURCE" name="BIZSITE_INSTRUCTION_LABEL"></bizsolo:getLabel></td>
<td border="1" colspan="3" class="ApSegGenData"><sbm:message key="workstep.Start.instruction" escapeLine="true"></sbm:message></td></tr>
</table>
</td>
</tr>
</table>

    
      
    
    <link rel="stylesheet" type="text/css" href="style/commonForAudit.css" />
<script type="text/javascript" src="script/commonJS.js"></script>
<div class="webPageContainer" >
<div class="header" >
 Schedule Technical Audit
</div>

<input value="" name="bizsite_instanceName" id ="bizsite_instanceName" size="30" type="text" class="InptTxt" alt="blank" style='display:none;'>
    <br clear="all">
<div id="tableContainerDiv" >
<table id="scheduleAuditTable" name="scheduleAuditTable" width="90%" align="center" cellspacing="10">
<tr>
<td>
<span class="label">Audit Type<span class="required">*</span></span>
<span id="AuditTypeError" class="error_message" style="display:none;">Please Select Audit Type</span>
</td>
<td>
<span class="label">Region<span class="required">*</span></span>   
<span id="RegionError" class="error_message" style="display:none;">Please Select Region</span>    
</td>
<td>
<span class="label">Location Name<span class="required">*</span></span>
<span id="BranchError" class="error_message" style="display:none;">Please Select Location</span>
</td>
</tr>
<tr>
<td>
<span class="cell">
    <sfe:widget name="sbm.combobox" id="auditTypeDropDown" args="{'size':20, 'readonly':false, 'visible':true, 'disabled':false, 'cascade':false, 'level':0, 'validationType':'none', 'validation':{}, 'toolTip':'', 'tabOrder':'0'}" value="[{'selected':false,'value':'Select','label':'Select'},{'selected':false,'value':'Branch Office','label':'Branch Audit'},{'selected':false,'value':'Retail HUB Operation','label':'Retail HUB Operation'},{'selected':false,'value':'Commercial HUB Operation','label':'Commercial HUB Operation'},{'selected':false,'value':'OD Claims','label':'OD Claims'},{'selected':false,'value':'Legal Claims','label':'Legal Claims'},{'selected':false,'value':'Center Office','label':'Service Center Audit'}]" />
<script language="javascript">
<!--
jmaki.subscribe("/sbm/combobox/onChange", function(args){if(args.widgetId=='auditTypeDropDown'){auditTypeDropDown_onChange(args);}});

-->
</script>
    <br clear="all">
</span></td>
<td><span class="cell">
  
    <sfe:widget name="sbm.combobox" id="regionDropDown" args="{'size':20, 'readonly':false, 'visible':true, 'disabled':false, 'cascade':false, 'level':0, 'validationType':'none', 'validation':{}, 'toolTip':'', 'tabOrder':'0'}" />
<script language="javascript">
<!--
jmaki.subscribe("/sbm/combobox/onChange", function(args){if(args.widgetId=='regionDropDown'){regionDropDown_onChange(args);}});

-->
</script>
    <br clear="all">
</span></td>
<td><span class="cell">
    <sfe:widget name="sbm.combobox" id="branchDropDown" args="{'size':20, 'readonly':false, 'visible':true, 'disabled':false, 'cascade':false, 'level':0, 'validationType':'none', 'validation':{}, 'toolTip':'', 'tabOrder':'0'}" />
<script language="javascript">
<!--
jmaki.subscribe("/sbm/combobox/onChange", function(args){if(args.widgetId=='branchDropDown'){branchDropDown_onChange(args);}});

-->
</script>
    <br clear="all">
</span></td>
</tr>
<tr>
<td>
<span class="label">Regional Incharge<span class="required">*</span></span>           
<span id="ROCError" class="error_message" style="display:none;">Please Select Regional Incharge</span>
</td>
<td>
<span class="label">Location Incharge<span class="required">*</span></span> 
<span id="BSMError" class="error_message" style="display:none;">Please Select Location Incharge</span>
</td>
<td>
<span class="label">Auditor<span class="required">*</span></span>
<span id="AuditorError" class="error_message" style="display:none;">Please Select Auditor</span>
</td>
</tr>
<tr>
<td><span class="cell">
    <sfe:widget name="sbm.combobox" id="ROCDropDown" args="{'size':20, 'readonly':false, 'visible':true, 'disabled':false, 'cascade':false, 'level':0, 'validationType':'none', 'validation':{}, 'toolTip':'', 'tabOrder':'0'}" value="[{'selected':true,'value':'Select','label':'Select'},{'selected':false,'value':'70008468-Sanjeev Chatrath','label':'70008468-Sanjeev Chatrath'},{'selected':false,'value':'70172879-Amit Jain','label':'70172879-Amit Jain'},{'selected':false,'value':'70030233-Gaurav Srivastava','label':'70030233-Gaurav Srivastava'},{'selected':false,'value':'70026943-Rahul Velankar','label':'70026943-Rahul Velankar'},{'selected':false,'value':'70258556-Puneet Sukla','label':'70258556-Puneet Sukla'},{'selected':false,'value':'70005091-Hema Chandra Reddy','label':'70005091-Hema Chandra Reddy'},{'selected':false,'value':'70250071-Geosh Roshan','label':'70250071-Geosh Roshan'},{'selected':false,'value':'70017695-Amit Kumar','label':'70017695-Amit Kumar'},{'selected':false,'value':'70008805-Chidambaram L','label':'70008805-Chidambaram L'}]" />
<script language="javascript">
<!--
jmaki.subscribe("/sbm/combobox/onChange", function(args){if(args.widgetId=='ROCDropDown'){ROCDropDown_onChange(args);}});

-->
</script>
    <br clear="all">
</span></td>

<td><span class="cell">
    <sfe:widget name="sbm.combobox" id="BSMDropdown" args="{'size':20, 'readonly':false, 'visible':true, 'disabled':false, 'cascade':false, 'level':0, 'validationType':'none', 'validation':{}, 'toolTip':'', 'tabOrder':'0'}" />
<script language="javascript">
<!--
jmaki.subscribe("/sbm/combobox/onChange", function(args){if(args.widgetId=='BSMDropdown'){BSMDropdown_onChange(args);}});

-->
</script>
    <br clear="all">
</span></td>
<td><span class="cell">
    <sfe:widget name="sbm.combobox" id="auditorDropDown" args="{'size':20, 'readonly':false, 'visible':true, 'disabled':false, 'cascade':false, 'level':0, 'validationType':'none', 'validation':{}, 'toolTip':'', 'tabOrder':'0'}" value="[{'selected':true,'value':'Select','label':'Select'},{'selected':false,'value':'70028861-Keshav Sharma','label':'70028861-Keshav Sharma'},{'selected':false,'value':'70162009-Saikat Sanbui','label':'70162009-Saikat Sanbui'},{'selected':false,'value':'10010097-Suresh C Ramachandran','label':'10010097-Suresh C Ramachandran'},{'selected':false,'value':'70005195-Pradyut Mullick','label':'70005195-Pradyut Mullick'},{'selected':false,'value':'70031473-Jagdish Mundra','label':'70031473-Jagdish Mundra'},{'selected':false,'value':'70006254-Lekha Bharathan','label':'70006254-Lekha Bharathan'},{'sdeWidgetKey':''}]" />
<script language="javascript">
<!--
jmaki.subscribe("/sbm/combobox/onChange", function(args){if(args.widgetId=='auditorDropDown'){auditorDropDown_onChange(args);}});

-->
</script>
    <br clear="all">
</span></td>
</tr>
<tr>
<td>
<span class="label">Zonal Incharge<span class="required">*</span></span>
<span id="ZOMError" class="error_message" style="display:none;">Please Enter Zonal Incharge</span>
</td>
<td>
<span class="label">ECRG Head<span class="required">*</span></span> 
</td>
<td>
<span class="label">Email Subject<span class="required">*</span></span>
<span id="SubjectError" class="error_message" style="display:none;">Please Enter Subject</span>
</td>
</tr>
<tr>
<td><span class="cell">
    <sfe:widget name="sbm.textfield" id="zonalHeadManager" args="{'type':'text', 'size':20, 'maxlength':256, 'readonly':false, 'visible':true, 'disabled':false, 'validationType':'none', 'validation':{}, 'toolTip':'', 'tabOrder':'0'}" />
<script language="javascript">
<!--
jmaki.subscribe("/sbm/textfield/onChange", function(args){if(args.widgetId=='zonalHeadManager'){zonalHeadManager_onChange(args);}});

-->
</script>
    <br clear="all">
</span></td>
<td><span class="cell">
    <sfe:widget name="sbm.textfield" id="ECRGHeadManager" args="{'type':'text', 'size':20, 'maxlength':256, 'readonly':false, 'visible':true, 'disabled':false, 'validationType':'none', 'validation':{}, 'toolTip':'', 'tabOrder':'0'}" />

    <br clear="all">
</span></td>
<td><span class="cell">
<input type="text" class="ApInptSelect" id="subject" name="subject" onChange="subjectOnChange();" onClick='openPopupForSub(this);' size="30" />
</span></td>
<tr>
<td>
<span class="label">Audit Start Date<span class="required">*</span></span>           
<span id="Audit_S_DateError" class="error_message" style="display:none;">Please Select Audit Start Date</span>
<span id="Audit_S_DateError1" class="error_message" style="display:none;">Please Select Valid Start Date</span>
</td>
<td>
<span class="label">Audit End Date<span class="required">*</span></span> 
<span id="Audit_E_DateError" class="error_message" style="display:none;">Please Select Audit End Date</span>
<span id="Audit_E_DateError1" class="error_message" style="display:none;">Please Select Valid End Date</span>
</td>
<td>
<span class="label">Message for Auditee<span class="required">*</span></span>
<span id="AuditeeMessageError" class="error_message" style="display:none;">Please Enter Auditee Message</span>
</td>
</tr>
<tr>
<td><span class="cell">
    <sfe:widget name="form.datetime" id="dateTime1" args="{'dateonly':false, 'visible':true, 'readonly':false, 'validationType':'none', 'validation':{}, 'toolTip':'', 'tabOrder':'0'}" />
<script language="javascript">
<!--
jmaki.subscribe("/dojo/dropdownDatePicker/onSelect", function(args){if(args.widgetId=='dateTime1'){dateTime1_onSelect(args);}});

-->
</script>
    <br clear="all">
</span></td>
<td><span class="cell">
    <sfe:widget name="form.datetime" id="dateTime2" args="{'dateonly':false, 'visible':true, 'readonly':false, 'validationType':'none', 'validation':{}, 'toolTip':'', 'tabOrder':'0'}" />
<script language="javascript">
<!--
jmaki.subscribe("/dojo/dropdownDatePicker/onSelect", function(args){if(args.widgetId=='dateTime2'){dateTime2_onSelect(args);}});

-->
</script>
    <br clear="all">
</span></td>
<td><span class="cell">
<input type="text" class="ApInptSelect" id="auditeeMessage" onChange="messageOnChange();" onClick="openPopUpForMessage(this);" name="auditeeMessage" size="30" />
</span></td>
</tr>
<tr>
<td>
<span class="label">E-mail of Auditee<span class="required">*</span></span>           
<span id="AuditeeMailError" class="error_message" style="display:none;">Please Enter Auditee E-mail</span>
<span id="AuditeeMailError1" class="error_message" style="display:none;">Please Enter Valid E-mail Id.</span>
</td>
<td>
<span class="label">E-mail Id of Others</span> 
</td>
<td>
<span class="label">Document Sample List</span>
</td>
</tr>
<tr>
<td><span class="cell">
<input type="text" class="ApInptSelect" id="auditeeMailId" name="auditeeMailId" onChange="auditeeMailOnChange();" size="30" />
</span></td>
<td><span class="cell">
<input type="text" class="ApInptSelect" id="othersMailId" name="othersMailId" onClick='openPopupForOtherMail(this);' size="30"  />
</span></td>
<td><span class="cell">

    <div style="display: inline;" id="document1"><bizsolo:getDS type="field" name="sampleDoc" multiline="true" wsName="Start" appendWith="false" isStart="true"></bizsolo:getDS></div>


    <br clear="all">
</span></td>

</tr>

<tr>

<td colspan="3" rowspan="2" >
<div style="margin-left:385px;">
    <br clear="all">
<input class="ApScrnButton" name="InitiateSchedule" id="InitiateSchedule" type="button" tabindex="0" value="<sbm:message key='Start.InitiateSchedule.label'/>" onClick="return InitiateSchedule_onClick();" onMouseOut="this.className='ApScrnButton';" onMouseOver="this.className='ApScrnButtonHover';">

    <br clear="all">
</div>
</td>
</tr>
</table>
</div>
<div id="popupSubjectDiv">
  <table>
    <tr>
     <td>Subject :</td>
     <td><textarea cols='30' id='subInPopUp' rows='3' onkeypress='subLenLimitr();'></textarea></td>
    </tr>
    <tr>
      <td align="center" colspan="2"><div onClick='setValuesInSubject();' class='popupBtn' >OK</div></td>
    </tr>
  </table>
   <a href="#" class="cancel" onClick="cancelSubjectPopup();"></a>
</div>

<div id="popupMessageDiv">
  <table>
    <tr>
     <td>Message :</td>
     <td><textarea cols='50' id='messageInPopUp' rows='7'></textarea></td>
    </tr>
    <tr>
      <td align="center" colspan="2"><div onClick='setValuesInMessage();' class='popupBtn' >OK</div></td>
    </tr>
  </table>
   <a href="#" class="cancel" onClick="cancelMessagePopup();"></a>
</div>

<div id="popupOtherMailDiv">
   <table>
     <tr>
      <td colspan="2"><div class="error">Email Id should be comma separeted and these Email Id's will be in CC.</div></td>
     </tr>
     <tr>
       <td>Other Mail Id :</td>
       <td><textarea cols='30' id='otherMailInPopUp' rows='3'></textarea></td>
     </tr>
     <tr>
       <td colspan="2" align="center"><div onClick='setValuesInOtherMail();' class='popupBtn' >OK</div></td>
     </tr>
   </table>
   <a href="#" class="cancel" onClick="cancelOtherMailPopup();"></a>
</div>
<div id="virtualOffDiv">
    <div class='header'>Select your Virtual Office</div>
    <div id='optList' style='margin-top:5px;'></div>
</div>
<div id="fade"></div> 
</div>
<br />
<div style="display:none;">
    <br clear="all">
<sfe:widget name="sbm.textfield" id="auditeeUserName" args="{'type':'text', 'size':20, 'maxlength':256, 'readonly':false, 'visible':true, 'disabled':false, 'validationType':'none', 'validation':{}, 'toolTip':'', 'tabOrder':'0'}" />

    <br clear="all">
<sfe:widget name="sbm.textfield" id="auditorUserName" args="{'type':'text', 'size':20, 'maxlength':256, 'readonly':false, 'visible':true, 'disabled':false, 'validationType':'none', 'validation':{}, 'toolTip':'', 'tabOrder':'0'}" />

    <br clear="all">
<sfe:widget name="sbm.textfield" id="auditeeMailId1" args="{'type':'text', 'size':20, 'maxlength':256, 'readonly':false, 'visible':true, 'disabled':false, 'validationType':'none', 'validation':{}, 'toolTip':'', 'tabOrder':'0'}" />

    <br clear="all">
<sfe:widget name="sbm.textfield" id="auditeeMailSubject1" args="{'type':'text', 'size':20, 'maxlength':2000, 'readonly':false, 'visible':true, 'disabled':false, 'validationType':'none', 'validation':{}, 'toolTip':'', 'tabOrder':'0'}" />

    <br clear="all">
<sfe:widget name="sbm.textfield" id="auditeeMessage1" args="{'type':'text', 'size':20, 'maxlength':2000, 'readonly':false, 'visible':true, 'disabled':false, 'validationType':'none', 'validation':{}, 'toolTip':'', 'tabOrder':'0'}" />

    <br clear="all">
<sfe:widget name="sbm.textfield" id="othersMailId1" args="{'type':'text', 'size':20, 'maxlength':2000, 'readonly':false, 'visible':true, 'disabled':false, 'validationType':'none', 'validation':{}, 'toolTip':'', 'tabOrder':'0'}" />

    <br clear="all">
<input class="ApScrnButton" name="bizsite_completeTask" id="CompleteButton" type="submit" tabindex="0" value="<bizsolo:getLabel name='COMPLETE_LABEL' type='RESOURCE'/>" onMouseOut="this.className='ApScrnButton';" onMouseOver="this.className='ApScrnButtonHover';" onClick="clickedButton=this.name;this.onsubmit = new Function('return false');">

    <br clear="all">
</div>

<style>
table#scheduleAuditTable
{
  border:1px solid #98b8df;
  border-collapse:collapse;
  background-color:#D2E0F1;
}
table td select,input
{
  width:200px;
}

</style>
    

</div>
<!-- Footer -->

<div id="cmdDiv" style="height:46px;">
<table width="100%" height="100%" cellpadding="0" align="center" cellspacing="0" border="0">
<tr align="center">
<td class="ApButtonDarkBg" width="63%">
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td class="ApBtnSpace">
<form:button id="bizsite_completeTask" name="bizsite_completeTask" link="CREATE_LABEL" resourceType="RESOURCE"/> </td>
<td class="ApBtnSpace">
<form:button id="bizsite_reset" name="bizsite_reset" link="RESET_LABEL" onclick="sbm.utils.reset" resourceType="RESOURCE"/> </td>
<td class="ApBtnSpace">
<form:button id="btn-cancel" name="btn-cancel" link="CANCEL_LABEL" onclick="sbm.utils.cancel" resourceType="RESOURCE"/> </td>
</tr>
</table>
</td>
</tr>
</table>
</div>

  
                    <div id="resizablepanel" style="display:none">
                        <div class="hd">Alert Dialog</div>
                        <div class="bd"></div>
                        <div class="ft"></div>
                    </div> 
<div id="southDiv" style="height:0px;display:none;"></div></form>
</body>

<script language="JavaScript">
<!--
function beforeInitControls() {
}
-->
</script>
<script language="JavaScript">
<!--
function userValidationJavascript() {
return true;
}
-->
</script>
<sbm:dataSources appName="InternalAuditTechnical" appType="bizlogic">
</sbm:dataSources>
<script language="JavaScript">
<!--
function region_createList(list){
  var defaultOption = new Array(1);
  defaultOption[0] = 'Select';
  sbm.util.removeAllOptions('regionDropDown');
  sbm.util.addOptions('regionDropDown',defaultOption);
  sbm.util.addOptions('regionDropDown',list);
}

function createZonalHead(zonalHead){
  document.getElementById('zonalHeadManager').value = zonalHead;
}

function branch_createList(list){
  var defaultOption = new Array(1);
  defaultOption[0] = 'Select';
  sbm.util.removeAllOptions('branchDropDown');
  sbm.util.addOptions('branchDropDown',defaultOption);
  sbm.util.addOptions('branchDropDown',list);
}

function createAuditorList(WsList){
 var defalultOption = new Array(1);
 defalultOption[0] = 'Select';
 sbm.util.removeAllOptions('auditorDropDown');
 sbm.util.addOptions("auditorDropDown", defalultOption);
 sbm.util.addOptions("auditorDropDown", WsList);
}

function branchHead_createList(WsList){
  var defalultOption = new Array(1);
   defalultOption[0] = 'Select';
   var map = WsList;
   var bm = map['BM'];
   var bsm = map['BSM'];
   
 var regionName = sbm.util.getValue('regionDropDown');
   var auditType = sbm.util.getValue('auditTypeDropDown');
   var branchName = sbm.util.getValue('branchDropDown');
   
   
   if(branchName == 'Kolkata I' && auditType == 'Branch Office' && regionName =='West Bengal & North East')
   {
    bsm = ['70038060-Arpita Ghosh'];
   }
   
   var defalultOption = new Array(1);
   defalultOption[0] = 'Select';
  // sbm.util.removeAllOptions('ROCDropDown');
  // sbm.util.addOptions('ROCDropDown', defalultOption);
  // sbm.util.addOptions('ROCDropDown', bm);
   sbm.util.removeAllOptions('BSMDropdown');
   sbm.util.addOptions('BSMDropdown', defalultOption);
   sbm.util.addOptions('BSMDropdown', bsm);    
   showVirtualOfficeList();  
}

function setAuditeeMailId(emailId){
  document.getElementById('auditeeMailId').value = emailId;
}

function messageOnChange(){
  if(document.getElementById('AuditeeMessageError').style.display = 'block'){
    document.getElementById('AuditeeMessageError').style.display = 'none';
  }
}

function auditeeMailOnChange(){
   if(document.getElementById('AuditeeMailError').style.display = 'block'){
    document.getElementById('AuditeeMailError').style.display = 'none';
  }
}

function subjectOnChange(){
   if(document.getElementById('SubjectError').style.display = 'block'){
    document.getElementById('SubjectError').style.display = 'none';
  }
}

function checkValidDate(date){
 var dateandyear = date.split(',');
 var month = dateandyear[0].split(' ')[0];
 var date = dateandyear[0].split(' ')[1];
 //var year = dateandyear[1];
 var year = dateandyear[1].trim().split(' ')[0];
 var monthNumber = ["Jan", "Feb", "Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].indexOf(month) + 1;
 var date = new Date( year, monthNumber - 1, date );
 var today = new Date();
 today.setHours(0);
 today.setMinutes(0);
 today.setSeconds(0);
 if(date.toString() == today.toString()){
    return true;
 }else if (  date > today ) {
  return true;
 }
 else {
  return false;
 } 
}

function checkValidEndDate(startDate,endDate){
 var start_dateandyear = startDate.split(',');
 var start_month = start_dateandyear[0].split(' ')[0];
 var start_date = start_dateandyear[0].split(' ')[1];
 //var start_year = start_dateandyear[1];
 var start_year = start_dateandyear[1].trim().split(' ')[0];
 
 var end_dateandyear = endDate.split(',');
 var end_month = end_dateandyear[0].split(' ')[0];
 var end_date = end_dateandyear[0].split(' ')[1];
 //var end_year = end_dateandyear[1];
 var end_year = end_dateandyear[1].trim().split(' ')[0];

 
 //var monthNumber = ["Jan", "Feb", "Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].indexOf(month) + 1;
 var startingDate = new Date( start_year, getMonthCnt(start_month) - 1, start_date );
 var endingDate = new Date( end_year, getMonthCnt(end_month) - 1, end_date );
 if (startingDate > endingDate  ) {
  return false;
 }
 else {
  return true;
 } 
}

function getMonthCnt(month)
{
   var monthNumber = ["Jan", "Feb", "Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].indexOf(month) + 1;
   return monthNumber;
}


var startDateOnChange = document.getElementById('dateTime1_id-inputEl');
startDateOnChange.setAttribute("onchange", function(){
 if(document.getElementById('Audit_S_DateError').style.display == 'block'){
   document.getElementById('Audit_S_DateError').style.display = 'none';
 }
  if(!checkValidDate(startDateOnChange.value)){
    validStartDateMsg();
    document.getElementById('dateTime1_id-inputEl').value = '';
  }else{
     document.getElementById('dateTime2_id-inputEl').value = '';
  }
});

var endDateOnChange = document.getElementById('dateTime2_id-inputEl');
endDateOnChange.setAttribute("onchange", function(){

 if(document.getElementById('Audit_E_DateError').style.display == 'block'){
   document.getElementById('Audit_E_DateError').style.display = 'none';
 }
  if(!isStartDateEntered()){
   insertStartDateMsg();
   document.getElementById('dateTime2_id-inputEl').value = '';
 }else{
  if(!checkValidEndDate(document.getElementById('dateTime1_id-inputEl').value,document.getElementById('dateTime2_id-inputEl').value)){
    validEndDateMsg();
    document.getElementById('dateTime2_id-inputEl').value = '';
  }else{}
  }
});

function validStartDateMsg(){
var abc ="Start Date should be greater than or equal to Today date.";
Ext.MessageBox.alert("Audit Start Date", abc, null);
}

function validEndDateMsg(){
var abc ="End Date should be greater than or equal to Start date.";
Ext.MessageBox.alert("Audit End Date", abc, null);
}

function insertStartDateMsg(){
var abc ="Please select Audit Start Date.";
Ext.MessageBox.alert("Audit Start Date", abc, null);
}

function subLenLimitr()
{
    wordLimiter(document.getElementById('subInPopUp'),80);
}
function isStartDateEntered(){
  if(document.getElementById('dateTime1_id-inputEl').value != ''){
    return true;
  }else{
    return false;
  }
}

function getLegalODClaim_ZonalInchrgeList(auditTypeName,regionName)
{
    var xmlhttp=new XMLHttpRequest();
    xmlhttp.onreadystatechange=function() 
    {
	if (xmlhttp.readyState == 4 && xmlhttp.status == 200) 
	{
	    var val = xmlhttp.responseText.toString();
	    val = val.trim();
	    document.getElementById('zonalHeadManager').value = val;
        }
    }
    xmlhttp.open("GET","Get_OD_LegalClaim_ZonalInchargeList.jsp?auditTypeName="+auditTypeName+"&regionName="+regionName, true);    	
    xmlhttp.send(); 
}

function getLocationList(auditTypeName,regionName)
{
        var xmlhttp=new XMLHttpRequest();
        xmlhttp.onreadystatechange=function() 
        {
    	    if (xmlhttp.readyState == 4 && xmlhttp.status == 200) 
    	       {
    		   sbm.util.removeAllOptions('branchDropDown');
    		   var select = document.getElementById('branchDropDown');
    		   var val = xmlhttp.responseText.toString();
    		   val = val.trim();
    		   if(auditTypeName == 'OD Claims' || auditTypeName == 'Legal Claims')
    		   {
    		       val = val.substring(1,val.length-1);
    		   }
    		   var locations = val.split(',');
    		   var opt = document.createElement('option');
    		   opt.value = "Select";
    		   opt.innerHTML = "Select";
      	             select.appendChild(opt);
    		   for(var i = 0; i < locations.length; i++)
    		   {
    		       if(locations[i].trim() != '' || locations[i].trim() != null)
    		       {
    	                     var opt = document.createElement('option');
    		           opt.value = locations[i].trim();
    		           opt.innerHTML = locations[i].trim();
         	                      select.appendChild(opt);
    	                  }
    		   }
    	          }
    	}
        xmlhttp.open("GET","Locations.jsp?AuditType="+auditTypeName+"&Region="+regionName, true);    	
        xmlhttp.send(); 
}

function validAuditeeMailIdMsg(){
var abc ="Please Insert Valid Auditee Mail Id.";
Ext.MessageBox.alert("Valid Mail Id", abc, null);
}

function setValuesInOtherMail(){
  var value = document.getElementById('otherMailInPopUp').value;
  var allMailIdArr = document.getElementById('otherMailInPopUp').value.split(',');
  for(var i=0;i<allMailIdArr.length;i++){
    if(!validateEmail(allMailIdArr[i])){
      validAuditeeMailIdMsg();
      return false;
    }else{
      otherMailObj.value = value;
    }
  }
  cancelOtherMailPopup();
}

var subjectInputObj;
function openPopupForSub(Obj){
    subjectInputObj = Obj;
    insertValueInPopUp(subjectInputObj.value,'subInPopUp');
    window.scrollTo(0,0);
    document.getElementById('popupSubjectDiv').style.display='block';
    document.getElementById('fade').style.display='block';
    document.getElementById('subInPopUp').focus();
}

function cancelSubjectPopup(){
  document.getElementById('popupSubjectDiv').style.display='none';
    document.getElementById('fade').style.display='none';
}

function setValuesInSubject(){
  subjectInputObj.value = document.getElementById('subInPopUp').value;
  cancelSubjectPopup();
}

var otherMailObj;
function openPopupForOtherMail(Obj){
    otherMailObj = Obj;
    insertValueInPopUp(otherMailObj.value,'otherMailInPopUp');
    window.scrollTo(0,0);
    document.getElementById('popupOtherMailDiv').style.display='block';
    document.getElementById('fade').style.display='block';
    document.getElementById('otherMailInPopUp').focus();
}

function cancelOtherMailPopup(){
  document.getElementById('popupOtherMailDiv').style.display='none';
    document.getElementById('fade').style.display='none';
}

function insertValueInPopUp(value,elementId){
  document.getElementById(elementId).value = value;
}

var messageInputObj;
function openPopUpForMessage(Obj){
    messageInputObj = Obj;
   // insertValueInPopUp(messageInputObj.value,'messageInPopUp');
    window.scrollTo(0,0);
    document.getElementById('popupMessageDiv').style.display='block';
    document.getElementById('fade').style.display='block';
    document.getElementById('messageInPopUp').focus();
}

function setValuesInMessage(){
  var content = document.getElementById('messageInPopUp').value;
  content = content.replace(/\t/g, '    ')
             .replace(/  /g, '&nbsp; ')
             .replace(/  /g, ' &nbsp;') 
             .replace(/\r\n|\n|\r/g, '<br />');
  messageInputObj.value = "";
  messageInputObj.value = content;
  cancelMessagePopup();
}

function cancelMessagePopup(){
  document.getElementById('popupMessageDiv').style.display='none';
  document.getElementById('fade').style.display='none';
}

function showVirtualOfficeList()
{
    var selectedBranch = document.getElementById('branchDropDown').value;
    if(selectedBranch != null && selectedBranch.trim().length > 0)
    {
       var xmlhttp=new XMLHttpRequest();
       xmlhttp.onreadystatechange=function() 
       {
           if (xmlhttp.readyState == 4 && xmlhttp.status == 200) 
           {
       	       var val = xmlhttp.responseText.toString();
       	       val = val.trim();
       	       if(val != null && val != 'null')
       	       { 
       	           val = val.substring(1,val.length-1);
       	           var virtulOfficeList = val.split(',');
       	           window.scrollTo(0,0);
	           var obj = document.getElementById('optList');
	           obj.innerHTML = '';
	           for(var i = 0; i < virtulOfficeList.length; i++)
	           {
	               var node = document.createElement('div');        
	               node.innerHTML = '<input type="checkbox" style="width:40px;" value="'+virtulOfficeList[i]+'" name="vrtlOffice"><label>'+ virtulOfficeList[i] +'</label>';       
	               obj.appendChild(node);         
	           }
	           var node = document.createElement('a');
	           node.innerHTML = 'OK';
	           node.className = 'popupBtn';
	           //node.onclick = function(){setVirtualOffices();}
	           node.addEventListener("click", setVirtualOffices);
	           obj.appendChild(node);
	           var button = document.createElement('a');
		 button.innerHTML = 'Cancel';
		 button.className = 'popupBtn';
		 button.addEventListener("click", closeVirtualOffices);
	           obj.appendChild(button);
	           document.getElementById('virtualOffDiv').style.display='block';
                     document.getElementById('fade').style.display='block';
               }
          }
       }
       xmlhttp.open("GET","GetVirtualOffices.jsp?location="+selectedBranch, true);
       xmlhttp.send();
    }
}

function setVirtualOffices()
{
    var voList = getCheckedBoxes();
    if(voList != '' && voList != null)
    {
        document.getElementById('messageInPopUp').value = "Virtual Office : "+voList;
    }
    document.getElementById('virtualOffDiv').style.display='none';
    document.getElementById('fade').style.display='none';
}

function closeVirtualOffices()
{
    document.getElementById('virtualOffDiv').style.display='none';
    document.getElementById('fade').style.display='none';
}

function getCheckedBoxes() 
{
    var checkboxes = document.getElementsByName("vrtlOffice");
    var checkboxesChecked = [];
    for (var i=0; i<checkboxes.length; i++) 
    {
        if (checkboxes[i].checked) 
        {
            checkboxesChecked.push(checkboxes[i].value);
        }
    }
    return checkboxesChecked;
}

 function auditorDropDown_onChange(eventContext){
{
if(document.getElementById('AuditorError').style.display == 'block')
{
  document.getElementById('AuditorError').style.display = 'none';
};
}}


 function branchDropDown_onChange(eventContext){
{
var regionName = sbm.util.getValue('regionDropDown');

var auditTypeName = sbm.util.getValue('auditTypeDropDown');

var branchName = sbm.util.getValue('branchDropDown');

if(regionName!='Select' && auditTypeName!='Select' && branchName!='Select'){



var xmlhttp1=new XMLHttpRequest();

xmlhttp1.onreadystatechange=function() 

{

    if (xmlhttp1.readyState == 4 && xmlhttp1.status == 200) 

       {

	   sbm.util.removeAllOptions('ROCDropDown');

	   var select = document.getElementById('ROCDropDown');

	   var val = xmlhttp1.responseText.toString();

	   val = val.trim();





	   if(auditTypeName == 'OD Claims' || auditTypeName == 'Legal Claims' || auditTypeName == 'Branch Office')

	   {

	       val = val.substring(1,val.length-1);    

	       var opt = document.createElement('option');

	       opt.value = 'Select';

	       opt.innerHTML = 'Select';

	       select.appendChild(opt);

	   }

	   var regionIncharges = val.split(',');

            if(auditTypeName == 'Branch Office' && branchName == 'Kolkata I')

            {

                regionIncharges = ['70008439-Anupam Kumar'];

            }

          

           

	   for(var i = 0; i < regionIncharges.length; i++)

	   {

	       if(regionIncharges[i].trim() != '' || regionIncharges[i].trim() != null)

	       {

                   var opt = document.createElement('option');

	           opt.value = regionIncharges[i].trim();

	           opt.innerHTML = regionIncharges[i].trim();

                   select.appendChild(opt);

               }

	   }

       }

}

xmlhttp1.open("GET","RegionalIncharges.jsp?AuditType="+auditTypeName+"&regionName="+regionName+"&branchName="+branchName, true);

xmlhttp1.send();



    if(auditTypeName == 'Branch Office')

    {

        getBranchHead(branchName, branchHead_createList);   

    }

    else

    {

            var xmlhttp=new XMLHttpRequest();

	    xmlhttp.onreadystatechange=function() 

	    {

	        if (xmlhttp.readyState == 4 && xmlhttp.status == 200) 

	           {

		       sbm.util.removeAllOptions('BSMDropdown');

		       var select = document.getElementById('BSMDropdown');

		       var val = xmlhttp.responseText.toString();

		       val = val.trim();

		       var opt = document.createElement('option');

		       opt.value = "Select";

		       opt.innerHTML = "Select";

		       select.appendChild(opt);

		       if(auditTypeName.trim() == 'OD Claims' || auditTypeName.trim() == 'Legal Claims')

		       {

		            val = val.substring(1,val.length-1);

		       }

		       var locationIncharges = val.split(',');

		       for(var i = 0; i < locationIncharges.length; i++)

		       {

		           if(locationIncharges[i].trim() != '' || locationIncharges[i].trim() != null)

		           {

		               var opt = document.createElement('option');

		               opt.value = locationIncharges[i].trim();

		               opt.innerHTML = locationIncharges[i].trim();

		               select.appendChild(opt);

		           }

		       }

	           }

	    }

	    xmlhttp.open("GET","LocationInchrge.jsp?AuditType="+auditTypeName+"&Location="+branchName+"&regionName="+regionName, true);

            xmlhttp.send();

    }

}

if(document.getElementById('BranchError').style.display == 'block'){

  document.getElementById('BranchError').style.display = 'none';

};
}}


 function onLoad(eventContext){
{
var tbl = document.getElementsByTagName("table")[0];

if(tbl) tbl.parentNode.removeChild(tbl);

document.getElementById("cmdDiv").style.display = "none";

//getALLRegions(region_createList);

document.getElementById('auditTypeDropDown').options[6] = null;

var myName = arguments.callee.toString();

myName = myName.substr('function '.length);

myName = myName.substr(0, myName.indexOf('('));

if(myName == 'onLoad')

{

   document.getElementById('auditorDropDown').options[1] = null;   

   var x = document.getElementById('auditorDropDown');

   var option = document.createElement("option");

   option.text = "70167720-Siddhartha Sett";

   option.value = "70167720-Siddhartha Sett";

   x.add(option);

};
}}


 function BSMDropdown_onChange(eventContext){
{
var BSMValue = sbm.util.getValue('BSMDropdown');
var empCode = BSMValue.split("-")[0].trim();
var bsmName = BSMValue.split("-")[1].trim();
getEmailId(empCode,setAuditeeMailId);
//document.getElementById("subject").value = "Dear "+bsmName+" , Please reply to draft audit report.";
if(document.getElementById('BSMError').style.display == 'block')
{
  document.getElementById('BSMError').style.display = 'none';
};
}}


 function auditTypeDropDown_onChange(eventContext){
{
document.getElementById("ROCDropDown").options.length = 0;
//var regionName = sbm.util.getValue('regionDropDown');
var auditTypeName = sbm.util.getValue('auditTypeDropDown');
//if(regionName != 'Select' && auditTypeName != 'Select'){
//  getBranches(regionName, auditTypeName, branch_createList);
//}
if(document.getElementById('AuditTypeError').style.display == 'block')
{
  document.getElementById('AuditTypeError').style.display = 'none';
}
if(auditTypeName == 'Branch Office')
{
    getALLRegions(region_createList);
}
else if(auditTypeName == 'OD Claims' || auditTypeName == 'Legal Claims')
{
        var xmlhttp=new XMLHttpRequest();
	xmlhttp.onreadystatechange=function() 
	{
	    if (xmlhttp.readyState == 4 && xmlhttp.status == 200) 
	       {
	           sbm.util.removeAllOptions('regionDropDown');
	           var select = document.getElementById('regionDropDown');
	           var val = xmlhttp.responseText.toString();
	           val = val.trim();
	           val = val.substring(1,val.length-1);
	           var regions = val.split(',');
	           var opt = document.createElement('option');
		   opt.value = "Select";
		   opt.innerHTML = "Select";
    	           select.appendChild(opt);
	           for(var i = 0; i < regions.length; i++)
	           {
		       if(regions[i].trim() != '' || regions[i].trim() != null)
		       {
		           var opt = document.createElement('option');
		           opt.value = regions[i].trim();
		           opt.innerHTML = regions[i].trim();
		           select.appendChild(opt);
		       }
	           }
	       }
        }
        xmlhttp.open("GET","GetOD_LegalClaim_RegionList.jsp?auditType="+auditTypeName, true);
        xmlhttp.send();
}
else
{
    var xmlhttp=new XMLHttpRequest();
    xmlhttp.onreadystatechange=function() 
    {
        if (xmlhttp.readyState == 4 && xmlhttp.status == 200) 
           {
	       sbm.util.removeAllOptions('regionDropDown');
	       var select = document.getElementById('regionDropDown');
	       var val = xmlhttp.responseText.toString();
	       var regions = val.split(',');
	       for(var i = 0; i < regions.length; i++)
	       {
	           if(regions[i].trim() != '' || regions[i].trim() != null)
	           {
	               var opt = document.createElement('option');
	               opt.value = regions[i].trim();
	               opt.innerHTML = regions[i].trim();
	               select.appendChild(opt);
	           }
	       }
           }
    }
    xmlhttp.open("GET","Regions.jsp?AuditType="+auditTypeName, true);
    xmlhttp.send();
};
}}


 function dateTime2_onSelect(eventContext){
if(document.getElementById('Audit_E_DateError').style.display == 'block'){

   document.getElementById('Audit_E_DateError').style.display = 'none';

 }

  if(!isStartDateEntered()){

   insertStartDateMsg();

   document.getElementById('dateTime2_id-inputEl').value = '';

 }else{

  if(!checkValidEndDate(document.getElementById('dateTime1_id-inputEl').value,document.getElementById('dateTime2_id-inputEl').value)){

    validEndDateMsg();

    document.getElementById('dateTime2_id-inputEl').value = '';

  }else{}

  };
return true;}


 function regionDropDown_onChange(eventContext){
{
var regionName = sbm.util.getValue('regionDropDown');

var auditTypeName = sbm.util.getValue('auditTypeDropDown');

/*var xmlhttp=new XMLHttpRequest();

xmlhttp.onreadystatechange=function() 

{

    if (xmlhttp.readyState == 4 && xmlhttp.status == 200) 

       {

	   sbm.util.removeAllOptions('ROCDropDown');

	   var select = document.getElementById('ROCDropDown');

	   var val = xmlhttp.responseText.toString();

	   val = val.trim();

	   if(auditTypeName == 'OD Claims' || auditTypeName == 'Legal Claims')

	   {

	       val = val.substring(1,val.length-1);    

	       var opt = document.createElement('option');

	       opt.value = 'Select';

	       opt.innerHTML = 'Select';

	       select.appendChild(opt);

	   }

	   var regionIncharges = val.split(',');

	   for(var i = 0; i < regionIncharges.length; i++)

	   {

	       if(regionIncharges[i].trim() != '' || regionIncharges[i].trim() != null)

	       {

                   var opt = document.createElement('option');

	           opt.value = regionIncharges[i].trim();

	           opt.innerHTML = regionIncharges[i].trim();

                   select.appendChild(opt);

               }

	   }

       }

}

xmlhttp.open("GET","RegionalIncharges.jsp?AuditType="+auditTypeName+"&regionName="+regionName, true);

xmlhttp.send();*/

if(regionName != 'Select'){

  //getAuditorList(sbm.util.getValue('regionDropDown'), createAuditorList);

  if(auditTypeName.trim() == 'OD Claims' || auditTypeName.trim() == 'Legal Claims')

  {

      getLegalODClaim_ZonalInchrgeList(auditTypeName,regionName);

  }

  else

  {

      if(regionName.trim() == 'Delhi')

      {

          createZonalHead('Monu Vikas Gupta-70164762');

      }

      else

      {

          getZonalHead(regionName,createZonalHead);      

      }

  } 

}

if(regionName != 'Select' && auditTypeName != 'Select'){

    sbm.util.removeAllOptions('branchDropDown');

    if(auditTypeName == 'Branch Office')

    {

        getBranches(regionName, auditTypeName, branch_createList);  

    }

    else

    {

        getLocationList(auditTypeName,regionName);

    }

}

if(document.getElementById('RegionError').style.display == 'block')

{

  document.getElementById('RegionError').style.display = 'none';

};
}}


 function dateTime1_onSelect(eventContext){
if(document.getElementById('Audit_S_DateError').style.display == 'block'){

   document.getElementById('Audit_S_DateError').style.display = 'none';

 }

  if(!checkValidDate(document.getElementById('dateTime1_id-inputEl').value)){

    validStartDateMsg();

    document.getElementById('dateTime1_id-inputEl').value = '';

  }else{

     document.getElementById('dateTime2_id-inputEl').value = '';

  };
return true;}


 function zonalHeadManager_onChange(eventContext){
{
if(document.getElementById('ZOMError').style.display = 'block'){
    document.getElementById('ZOMError').style.display = 'none';
  };
}}


 function ROCDropDown_onChange(eventContext){
{
if(document.getElementById('ROCError').style.display == 'block')
{
  document.getElementById('ROCError').style.display = 'none';
};
}}


 function InitiateSchedule_onClick(eventContext){
{
var regionSelectObj = document.getElementById('regionDropDown');

var auditTypeSelectObj = document.getElementById('auditTypeDropDown');

var branchSelectObj = document.getElementById('branchDropDown');

var rocObj = document.getElementById('ROCDropDown');

var bsmObj = document.getElementById('BSMDropdown');

var auditorObj = document.getElementById('auditorDropDown');

var zonalHMObj = document.getElementById('zonalHeadManager');

var subjectObj = document.getElementById('subject');

var startDateObj = document.getElementById('dateTime1_id-inputEl');

var endDateObj = document.getElementById('dateTime2_id-inputEl');

var auditeeObj = document.getElementById('auditeeMessage');

var auditeeMailObj = document.getElementById('auditeeMailId');

var othersMailObj = document.getElementById('othersMailId');

var i=0;

document.getElementById('bizsite_instanceName').value = 'Audit_' + sbm.util.getValue('branchDropDown') + sbm.util.getValue('auditorDropDown');

if(regionSelectObj.value == 'Select' || regionSelectObj.value == '-1'){

  //regionSelectObj.focus();

  document.getElementById('RegionError').style.display = 'block';

//  return false;

i++;

}

if(auditTypeSelectObj.value == 'Select' || auditTypeSelectObj.value == '-1'){

  //branchTypeSelectObj.focus();

  document.getElementById('AuditTypeError').style.display = 'block';

//  return false;

i++;

}

if(branchSelectObj.value == 'Select' || branchSelectObj.value == '-1'){

 // branchSelectObj.focus();

document.getElementById('BranchError').style.display = 'block';

//  return false;

i++;

}

if(rocObj.value == 'Select' || rocObj.value == '-1'){

document.getElementById('ROCError').style.display = 'block';

//  return false;

i++;

}

if(bsmObj.value == 'Select' || bsmObj.value == '-1'){

document.getElementById('BSMError').style.display = 'block';

//  return false;

i++;

}

if(auditorObj.value == 'Select' || auditorObj.value == '-1'){

document.getElementById('AuditorError').style.display = 'block';

//  return false;

i++;

}

if(zonalHMObj.value == '' || zonalHMObj.value==null){

document.getElementById('ZOMError').style.display = 'block';

//  return false;

i++;

}else{

  if(document.getElementById('ZOMError').style.display = 'block'){

    document.getElementById('ZOMError').style.display = 'none';

  }

}

if(subjectObj.value == '' || subjectObj.value==null){

document.getElementById('SubjectError').style.display = 'block';

//  return false;

i++;

}else{

  if(document.getElementById('SubjectError').style.display = 'block'){

    document.getElementById('SubjectError').style.display = 'none';

  }

}

if(startDateObj.value=="" || startDateObj.value==null)

{

document.getElementById('Audit_S_DateError').style.display = 'block';

//return false;

i++;

}else{

  if(document.getElementById('Audit_S_DateError').style.display = 'block'){

    document.getElementById('Audit_S_DateError').style.display = 'none';

  }

}

if(endDateObj.value=="" || endDateObj.value==null){

document.getElementById('Audit_E_DateError').style.display = 'block';

//return false;

i++;

}else{

  if(document.getElementById('Audit_E_DateError').style.display = 'block'){

    document.getElementById('Audit_E_DateError').style.display = 'none';

  }

}

if(auditeeObj.value=="" || auditeeObj.value==null){

document.getElementById('AuditeeMessageError').style.display = 'block';

//return false;

i++;

}else{

  if(document.getElementById('AuditeeMessageError').style.display = 'block'){

    document.getElementById('AuditeeMessageError').style.display = 'none';

  }

}

if(auditeeMailObj.value=="" || auditeeMailObj.value==null){

document.getElementById('AuditeeMailError').style.display = 'block';

//return false;

i++;

}else if(!validateEmail(auditeeMailObj.value)){

   validAuditeeMailIdMsg();

   auditeeMailObj.value = "";

   i++;

}

else{

  if(document.getElementById('AuditeeMailError').style.display = 'block'){

    document.getElementById('AuditeeMailError').style.display = 'none';

  }

}

if(i!=0){

 return false;

}

sbm.util.setValue('regionDropDown',sbm.util.getValue('regionDropDown'));

sbm.util.setValue('auditTypeDropDown',sbm.util.getValue('auditTypeDropDown'));

sbm.util.setValue('branchDropDown',sbm.util.getValue('branchDropDown'));

sbm.util.setValue('ROCDropDown',sbm.util.getValue('ROCDropDown'));

sbm.util.setValue('BSMDropdown',sbm.util.getValue('BSMDropdown'));

sbm.util.setValue('auditorDropDown',sbm.util.getValue('auditorDropDown'));

var auditorDDValue = document.getElementById("auditorDropDown").value;

document.getElementById("auditorUserName").value = auditorDDValue.split("-")[0]; 

var auditeeDDValue = document.getElementById("BSMDropdown").value;

document.getElementById("auditeeUserName").value = auditeeDDValue.split("-")[0];

document.getElementById("auditeeMailSubject1").value = subjectObj.value; 

document.getElementById("auditeeMessage1").value = auditeeObj.value; 

document.getElementById("auditeeMailId1").value = auditeeMailObj.value; 

document.getElementById("othersMailId1").value = othersMailObj.value; 

alert('done');

document.getElementById("CompleteButton").click();;
}}

-->
</script>
<!--Initialize extensible widgets.-->
<script language="JavaScript">
<!--
var _dateFormats = {date:'<%=bean.getPropString(PublicResources.JS_CALENDAR_DATE_FORMAT)%>', dateOnly:'<%=bean.getPropString(PublicResources.JS_CALENDAR_DATE_ONLY_FORMAT)%>'};

var allWidgets = [{widget:'auditTypeDropDown', bound:'true', editable:'true', type:'sbm.combobox', source: {type:'STATIC'}, target:{type:'DATASLOT', dataSlotName:'branchType', dataSlotType:'STRING'}, dsType:'STRING', service:'false'},
{widget:'regionDropDown', bound:'true', editable:'true', type:'sbm.combobox', source: {type:'DATASLOT', dataSlotName:'region', dataSlotType:'STRING'}, target:{type:'DATASLOT', dataSlotName:'region', dataSlotType:'STRING'}, dsType:'STRING', service:'false'},
{widget:'branchDropDown', bound:'true', editable:'true', type:'sbm.combobox', source: {type:'DATASLOT', dataSlotName:'branch', dataSlotType:'STRING'}, target:{type:'DATASLOT', dataSlotName:'branch', dataSlotType:'STRING'}, dsType:'STRING', service:'false'},
{widget:'ROCDropDown', bound:'false', editable:'true', type:'sbm.combobox', source: {type:'STATIC'}, target:{type:'DATASLOT', dataSlotName:'RH', dataSlotType:'STRING'}, dsType:'', service:'false'},
{widget:'BSMDropdown', bound:'true', editable:'true', type:'sbm.combobox', source: {type:'DATASLOT', dataSlotName:'BSM', dataSlotType:'STRING'}, target:{type:'DATASLOT', dataSlotName:'BSM', dataSlotType:'STRING'}, dsType:'STRING', service:'false'},
{widget:'auditorDropDown', bound:'false', editable:'true', type:'sbm.combobox', source: {type:'STATIC'}, target:{type:'DATASLOT', dataSlotName:'auditor', dataSlotType:'STRING'}, dsType:'', service:'false'},
{widget:'zonalHeadManager', bound:'true', editable:'true', type:'sbm.textfield', source: {type:'DATASLOT', dataSlotName:'zonalHead', dataSlotType:'STRING'}, target:{type:'DATASLOT', dataSlotName:'zonalHead', dataSlotType:'STRING'}, dsType:'STRING', service:'false'},
{widget:'ECRGHeadManager', bound:'true', editable:'true', type:'sbm.textfield', source: {type:'DATASLOT', dataSlotName:'ECRGHead', dataSlotType:'STRING'}, target:{type:'DATASLOT', dataSlotName:'ECRGHead', dataSlotType:'STRING'}, dsType:'STRING', service:'false'},
{widget:'dateTime1', bound:'true', editable:'true', type:'form.datetime', source: {type:'DATASLOT', dataSlotName:'auditStartDate', dataSlotType:'DATETIME'}, target:{type:'DATASLOT', dataSlotName:'auditStartDate', dataSlotType:'DATETIME'}, dsType:'DATETIME', service:'false'},
{widget:'dateTime2', bound:'true', editable:'true', type:'form.datetime', source: {type:'DATASLOT', dataSlotName:'auditEndDate', dataSlotType:'DATETIME'}, target:{type:'DATASLOT', dataSlotName:'auditEndDate', dataSlotType:'DATETIME'}, dsType:'DATETIME', service:'false'},
{widget:'auditeeUserName', bound:'true', editable:'true', type:'sbm.textfield', source: {type:'DATASLOT', dataSlotName:'auditeeUserName', dataSlotType:'STRING'}, target:{type:'DATASLOT', dataSlotName:'auditeeUserName', dataSlotType:'STRING'}, dsType:'STRING', service:'false'},
{widget:'auditorUserName', bound:'true', editable:'true', type:'sbm.textfield', source: {type:'DATASLOT', dataSlotName:'auditor_username', dataSlotType:'STRING'}, target:{type:'DATASLOT', dataSlotName:'auditor_username', dataSlotType:'STRING'}, dsType:'STRING', service:'false'},
{widget:'auditeeMailId1', bound:'true', editable:'true', type:'sbm.textfield', source: {type:'DATASLOT', dataSlotName:'auditeeMailId', dataSlotType:'STRING'}, target:{type:'DATASLOT', dataSlotName:'auditeeMailId', dataSlotType:'STRING'}, dsType:'STRING', service:'false'},
{widget:'auditeeMailSubject1', bound:'true', editable:'true', type:'sbm.textfield', source: {type:'DATASLOT', dataSlotName:'auditeeMailSubject', dataSlotType:'STRING'}, target:{type:'DATASLOT', dataSlotName:'auditeeMailSubject', dataSlotType:'STRING'}, dsType:'STRING', service:'false'},
{widget:'auditeeMessage1', bound:'true', editable:'true', type:'sbm.textfield', source: {type:'DATASLOT', dataSlotName:'auditeeMessage', dataSlotType:'STRING'}, target:{type:'DATASLOT', dataSlotName:'auditeeMessage', dataSlotType:'STRING'}, dsType:'STRING', service:'false'},
{widget:'othersMailId1', bound:'true', editable:'true', type:'sbm.textfield', source: {type:'DATASLOT', dataSlotName:'othersMailId', dataSlotType:'STRING'}, target:{type:'DATASLOT', dataSlotName:'othersMailId', dataSlotType:'STRING'}, dsType:'STRING', service:'false'}
];
var businessObjects = [];
var formWidgetHandler;
  var def_priority='<%=com.savvion.sbm.util.PriorityHelper.self().getDefaultPriorityAsString()%>';
sbm.utils.onDOMReady = function() {
YAHOO.util.Event.onDOMReady(function(){
  sbm.utils.setPriority('bizsite_priority','<%=com.savvion.sbm.util.PriorityHelper.self().getDefaultPriorityAsString()%>');formWidgetHandler = new FormWidgetHandler(allWidgets,onLoad,{processName:'InternalAuditTechnical',processType:'bizlogic',maxMultiLineLength:${maxMultiLineLength},adapletCache:{'user':''}},'<%=request.getParameter(BizSoloRequest.BSS_FIID)%>');
 });
 }
Ext.onReady(function(){
 var task = new Ext.util.DelayedTask(function(){
});
  task.delay(500);
  var viewport = new Bm.util.BmViewport('',{resultComponentXtype:'container'});

});

   
    scrollToErrors = function() {
        var errorsDiv = document.getElementById('errors');
        if(errorsDiv !== null) {
            errorsDiv.scrollIntoView();
        }
    }
    sbm.utils.onFormSubmit = function() {
        if(!formWidgetHandler.validateWidgets()) {
            scrollToErrors();
            return false;
        }
        try{
            if(!userValidationJavascript()) {
                scrollToErrors();
                return false;
            }              
            sbm.utils.handleFormSubmit();
        }catch(e){
            scrollToErrors();
            return false;
        }

                            document.form.action='<%=response.encodeURL("Start.jsp")%>';
         if(allWidgets.length > 0)formWidgetHandler.saveDataSlots();
         return true;
}
-->
</script>

</html>